{% load express_tags %}

{% with table_name="big_table" %}
    {% with table_data=full_data|table_keyval:table_name %}
        <form action="/common/change_table" method="post" autocomplete="off" oninput="on_form_change(this)">
            <input hidden name="table_name" value="{{ table_name }}">
            <input hidden name="journal_page" value="{{ journal_page }}">
            <table class="table table-bordered">
                <thead>
                <tr>
                    <th> Концентрат</th>
                    <th> План на СМТ</th>
                    <th> План на 12 месяцев ГПП</th>
                    <th> План на 12 месяцев ТПП</th>
                    <th> Факт за 12 месяцев</th>
                    <th> Отклонение от ТПП</th>
                    <th> Отклонение от УПП</th>
                    <th> Соотношение</th>
                </tr>
                </thead>
                <tbody>
                {% if table_data.wagon_num|length == 0 %}
                    <tr class="indexed-line">
                        <input class="index-input" hidden name="index" value=0>
                        <td>{% include "value.html" with field_name="wagon_num" index=0 %}</td>
                        <td>{% include "value.html" with field_name="conc_num" index=0 %}</td>
                        <td>{% include "value.html" with field_name="supply_time" index=0 %}</td>
                        <td>{% include "value.html" with field_name="dispatch_time" index=0 %}</td>
                        <td>{% include "value.html" with field_name="downtime" index=0 %}</td>
                        <td>{% include "value.html" with field_name="recieved_conc" index=0 %}</td>
                        <td>{% include "value.html" with field_name="recieved_beds" index=0 %}</td>
                        <td>{% include "value.html" with field_name="recieved_stops" index=0 %}</td>
                    </tr>
                {% else %}
                    {% for _ in table_data.wagon_num %}
                        <tr class="indexed-line">
                            <input class="index-input" hidden name="index" value="{{ forloop.counter0 }}">
                            <td>{% include "value.html" with field_name="concentrate" index=forloop.counter0 %}</td>
                            <td>{% include "value.html" with field_name="smt_plan" index=forloop.counter0 %}</td>
                            <td>{% include "value.html" with field_name="gpp_year_plan" index=forloop.counter0 %}</td>
                            <td>{% include "value.html" with field_name="tpp_year_plan" index=forloop.counter0 %}</td>
                            <td>{% include "value.html" with field_name="fact_year" index=forloop.counter0 %}</td>
                            <td>{% include "value.html" with field_name="tpp_dispersion" index=forloop.counter0 %}</td>
                            <td>{% include "value.html" with field_name="upp_deviation" index=forloop.counter0 %}</td>
                            <td>{% include "value.html" with field_name="ratio" index=forloop.counter0 %}</td>
                        </tr>
                    {% endfor %}
                {% endif %}
                </tbody>
            </table>
        </form>
    {% endwith %}
{% endwith %}

<script>
    $()
</script>
