(function(t){function e(e){for(var a,i,r=e[0],l=e[1],c=e[2],d=0,m=[];d<r.length;d++)i=r[d],s[i]&&m.push(s[i][0]),s[i]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);u&&u(e);while(m.length)m.shift()();return o.push.apply(o,c||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],a=!0,r=1;r<n.length;r++){var l=n[r];0!==s[l]&&(a=!1)}a&&(o.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},s={app:0},o=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var u=l;o.push([1,"chunk-vendors"]),n()})({0:function(t,e){},"07d3":function(t,e,n){"use strict";var a=n("b454"),s=n.n(a);s.a},"0f96":function(t,e,n){},1:function(t,e,n){t.exports=n("56d7")},"115e":function(t,e,n){t.exports=n.p+"img/no-avatar.3c814347.png"},1548:function(t,e,n){"use strict";var a=n("d5ae"),s=n.n(a);s.a},2:function(t,e){},"21a8":function(t,e,n){},2856:function(t,e,n){},"2bb7":function(t,e,n){"use strict";var a=n("4b16"),s=n.n(a);s.a},"2d31":function(t,e,n){},"2fe3":function(t,e,n){"use strict";var a=n("90e6"),s=n.n(a);s.a},3:function(t,e){},"38a1":function(t,e){$(document).ready(function(){var t=$(".header"),e=0;$(window).scroll(function(){var n=$(this).scrollTop();100>n&&t.removeClass("hidden").addClass("sticky"),2<e-n&&100<n?t.removeClass("hidden").addClass("sticky"):10<n-e&&100<n&&t.removeClass("sticky").addClass("hidden"),e=n})})},"3adf":function(t,e,n){},"41a4":function(t,e,n){"use strict";var a=n("6570"),s=n.n(a);s.a},"44bc":function(t,e,n){"use strict";var a=n("a8d4"),s=n.n(a);s.a},4678:function(t,e,n){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-nz":"6f50","./en-nz.js":"6f50","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf75","./tlh.js":"cf75","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-tw":"90ea","./zh-tw.js":"90ea"};function s(t){var e=o(t);return n(e)}function o(t){var e=a[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}s.keys=function(){return Object.keys(a)},s.resolve=o,t.exports=s,s.id="4678"},4772:function(t,e,n){"use strict";var a=n("6ae6"),s=n.n(a);s.a},4923:function(t,e,n){"use strict";var a=n("ed58"),s=n.n(a);s.a},"4b16":function(t,e,n){},"4c8a":function(t,e,n){"use strict";var a=n("8571"),s=n.n(a);s.a},5092:function(t,e,n){"use strict";var a=n("d400"),s=n.n(a);s.a},"512f":function(t,e,n){"use strict";var a=n("3adf"),s=n.n(a);s.a},"54bb":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d");var a=n("a026"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},o=[],i={name:"app"},r=i,l=(n("5c0b"),n("2877")),c=Object(l["a"])(r,s,o,!1,null,null,null);c.options.__file="App.vue";var u=c.exports,d=(n("7f7f"),n("8c4f")),m=n("2b27"),f=n.n(m),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"elogs-container"},[n("top-nav"),n("div",{staticClass:"main-container"},[n("nav",{staticClass:"column-left"},["modesPage"!==t.$route.name?n("left-menu"):n("modes-left-menu")],1),n("div",{staticClass:"column-content",attrs:{id:"elogs-app"}},[n("router-view"),n("main-footer")],1)]),n("popup")],1)},h=[],v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("header",{staticClass:"header sticky"},[n("div",{staticClass:"header__logo",on:{click:function(e){e.preventDefault(),t.$router.push("/")}}},[n("i",{staticClass:"fab fa-font-awesome"}),n("span",[t._v(" E-Logs")])]),n("div",{staticClass:"header__title"},["defaultJournalPage"===t.$route.name?n("span",{staticClass:"plant_title"},[t._v(t._s(t.$store.getters["journalState/plantVerboseName"]))]):t._e(),t.$route.params.journal&&"modesPage"!==t.$route.name?[t.$store.getters["journalState/isSynchronized"]?t._e():n("i",{staticClass:"fa fa-circle-o-notch",staticStyle:{color:"#ca0000"},attrs:{id:"async","aria-hidden":"true"}},[t._v(" Синхронизация...")]),t.$store.getters["journalState/isSynchronized"]?n("i",{staticClass:"fa fa-check",staticStyle:{color:"#36d686"},attrs:{id:"sync","aria-hidden":"true"}},[t._v(" Синхронизировано")]):t._e()]:t._e()],2),n("div",{staticClass:"header__user"},[n("i",{staticClass:"fas fa-envelope user-messages-badge",on:{click:t.onMsgClick}}),n("i",{staticClass:"fas fa-bell"}),n("span",{staticClass:"user-name",on:{click:t.onUsernameClick}},[t._v(t._s(t.$store.getters["userState/username"]))]),n("i",{staticClass:"fas fa-user-circle",staticStyle:{"margin-right":"0"}}),n("div",{staticClass:"user-menu-wrapper"},[n("div",{staticClass:"user-menu"},[n("ul",{staticClass:"menu"},[n("li",{staticClass:"user-menu__item"},[n("a",{attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.onSettingsClick(e)}}},[n("i",{staticClass:"fas fa-cogs"}),n("span",{staticClass:"caption"},[t._v("Настройки")])])]),n("li",{staticClass:"user-menu__item"},[n("a",{attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.onAddJournal(e)}}},[n("i",{staticClass:"fas fa-journal-whills"}),n("span",{staticClass:"caption"},[t._v("Добавить журнал")])])]),n("li",{staticClass:"user-menu__item"},[n("a",{attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.onModesClick(e)}}},[n("i",{staticClass:"fas fa-sliders-h"}),n("span",{staticClass:"caption"},[t._v("Режимы")])])]),n("li",{staticClass:"user-menu__item"},[n("a",{attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.onMessagesClick(e)}}},[n("i",{staticClass:"fa fa-envelope"}),n("span",{staticClass:"caption"},[t._v("Список сообщений ")])])]),n("li",{staticClass:"user-menu__item"},[n("a",{attrs:{href:"javascript:;","data-toggle":"modal","data-target":"#SchemeModal"},on:{click:t.hideUserMenu}},[n("i",{staticClass:"fa fa-book"}),n("span",{staticClass:"caption"},[t._v("Схема цехов ")])])]),n("li",{staticClass:"user-menu__item"},[n("a",{attrs:{href:"javascript:;","data-toggle":"modal","data-target":"#MessageToDevelopersModal"},on:{click:t.hideUserMenu}},[n("i",{staticClass:"fas fa-user-edit"}),n("span",{staticClass:"caption"},[t._v("Оставить отзыв разработчикам")])])]),n("li",{staticClass:"user-menu__item"},[n("a",{attrs:{href:""},on:{click:function(e){return e.preventDefault(),t.onLogout(e)}}},[n("i",{staticClass:"fas fa-sign-out-alt"}),n("span",{staticClass:"caption"},[t._v("Выйти из системы")])])])])])]),n("div",{attrs:{id:"messages-app"}})])])},g=[],b={name:"TopNav",methods:{onLogout:function(){var t=this;this.$store.dispatch("userState/logout").then(function(){t.$router.push("/login")})},onUsernameClick:function(){$(".header .user-menu").hasClass("visible")?this.hideUserMenu():this.showUserMenu()},showUserMenu:function(){$(".header .user-menu").addClass("visible"),$(".header .user-menu-wrapper").addClass("visible")},hideUserMenu:function(){$(".header .user-menu").removeClass("visible"),$(".header .user-menu-wrapper").removeClass("visible")},onMsgClick:function(){var t=document.querySelector(".user-notifications");t.classList.toggle("display")},onSettingsClick:function(){this.$router.push("/settings"),this.hideUserMenu()},onAddJournal:function(){this.$router.push("/addjournal"),this.hideUserMenu()},onMessagesClick:function(){this.$router.push("/messages"),this.hideUserMenu()},onModesClick:function(){this.$router.push("/modes"),this.hideUserMenu()}},mounted:function(){var t=this;$(".header .user-menu-wrapper").click(function(){t.hideUserMenu()}),$(".header .user-menu").click(function(t){t.stopPropagation()})}},C=b,j=(n("512f"),Object(l["a"])(C,v,g,!1,null,"3302fa76",null));j.options.__file="TopNav.vue";var S=j.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"menu__panel"},[n("div",{staticClass:"menu__title"},[t._v("Список цехов")]),n("i",{staticClass:"menu__toggle fas fa-bars",on:{click:t.toggleMenu}})]),t._m(0),n("ul",{staticClass:"menu menu--left"},[n("li",{staticClass:"menu__item",staticStyle:{"padding-bottom":"10px"},on:{click:t.onDashboardClick}},[t._m(1)]),t._l(t.getPlants,function(e){return n("li",{key:e.name,staticClass:"menu__item",on:{click:t.onMenuItemClick}},[n("a",{staticClass:"menu-item__link",attrs:{href:"#"}},[n("i",{staticClass:"menu-item__icon fa fa-book"}),n("span",{staticClass:"menu-item__title"},[t._v(t._s(e.verbose_name))]),n("b",{staticClass:"arrow fa fa-angle-down"})]),n("ul",{staticClass:"sub-menu"},t._l(e.journals,function(a){return n("li",{key:a.name,staticClass:"menu__item"},[n("a",{staticClass:"menu-item__link",attrs:{href:"","data-plant-name":e.name,"data-journal-name":a.name}},[t._v(t._s(a.verbose_name))])])}))])})],2)])},w=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu__logo"},[n("i",{staticClass:"fas fa-sitemap"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{staticClass:"menu-item__link",attrs:{"data-url":"/dashboard"}},[n("i",{staticClass:"menu-item__icon fa fa-book"}),n("span",{staticClass:"menu-item__title"},[t._v("Панель аналитики")])])}],y=n("6bde"),N=n("1157"),M=n.n(N),E={name:"Menu",data:function(){return{menuSelector:".menu--left"}},computed:{getPlants:function(){return this.$store.getters["journalState/plants"]}},mounted:function(){var t=this;this.$store.dispatch("journalState/loadPlants").then(function(){setTimeout(function(){return t.setListeners()},0),"/dashboard"===location.pathname?setTimeout(function(){return t.onDashboardClick()},0):setTimeout(function(){return t.setActiveItem()},0)})},methods:{toggleMenu:function(){M()(".column-left").toggleClass("menu__hidden"),M()(".column-content").toggleClass("menu__hidden")},onMenuItemClick:function(){var t=this;event.preventDefault();var e=event.target.closest("li.menu__item"),n=e.querySelector("a.menu-item__link"),a=n.getAttribute("data-plant-name"),s=n.getAttribute("data-journal-name"),o=(M()(".menu.menu--left"),"");a&&s&&(o="/"+a+"/"+s),null!==o&&""!==o&&"#"!==o?this.$store.getters["journalState/isSynchronized"]&&this.$store.dispatch("journalState/loadJournal",{plantName:a,journalName:s}).then(function(e){t.$router.push("/"+a+"/"+s+"/"+e),t.setActiveItem(),t.$store.dispatch("journalState/loadShifts",{plant:a,journal:s}),768>M()("#app").outerWidth()&&t.toggleMenu()}):e.classList.toggle("open")},onDashboardClick:function(){var t=document.querySelector('span.menu-item__link[data-url="/dashboard"]').closest("li.menu__item");this.closeAllItems(),t.classList.toggle("open"),this.$router.push("/dashboard")},setListeners:function(){var t=M()(".column-left"),e=M()(".menu__logo"),n=0,a=M()(".menu__panel").outerHeight()+e.outerHeight(),s=M()(".header").outerHeight();M()(".menu--left").css({height:"calc(100vh - ".concat(a+s+16,"px)")}),M()(window).scroll(function(){var e=M()(this).scrollTop();100>e&&t.css({top:"50px"}),2<n-e&&100<e?(t.css({top:"50px"}),M()(".menu--left").css({height:"calc(100vh - ".concat(a+s+16,"px)")})):10<e-n&&100<e&&(t.css({top:"0px"}),M()(".menu--left").css({height:"calc(100vh - (".concat(a+16,"px))")})),n=e})},setActiveItem:function(){function t(e,n){return e.classList.contains(n)?e:t(e.parentNode,n)}this.closeAllItems();var e=document.querySelector('.menu__item a[data-journal-name="'.concat(this.$route.params.journal,'"]'));if(e){var n=e.parentNode;n.classList.add("open");var a=t(n.parentNode,"menu__item");a.classList.add("open")}},closeAllItems:function(){var t=document.querySelectorAll(".menu--left .menu__item");for(var e in t){var n=t[e];"object"===Object(y["a"])(n)&&n.classList.remove("open")}}}},k=E,T=(n("2bb7"),Object(l["a"])(k,x,w,!1,null,"7b54c468",null));T.options.__file="Menu.vue";var O=T.exports,A=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"menu__panel menu__panel--modes"},[n("div",{staticClass:"menu__title"},[t._v("Список режимов")]),n("i",{staticClass:"menu__toggle fas fa-bars",on:{click:t.toggleMenu}})]),t._m(0),n("ul",{staticClass:"menu menu--left menu--modes"},t._l(t.getModes,function(e){return n("li",{staticClass:"menu__item",staticStyle:{"padding-bottom":"10px"},attrs:{id:e.id},on:{click:function(n){t.onMenuItemClick(e.id)}}},[n("span",[t._v(t._s(e.message))]),n("i",{staticClass:"fas fa-circle is-active-icon",style:{color:e.is_active?"#9FBF47":"#FF734C"}})])}))])},I=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"menu__sub-title"},[n("button",{staticClass:"btn",attrs:{"data-toggle":"modal","data-target":"#addModeModal"}},[t._v("Добавить режим")])])}],L=(n("28a5"),n("386d"),{name:"ModesMenu",data:function(){return{menuSelector:".menu--left"}},computed:{getModes:function(){return this.$store.getters["modesState/modes"]}},mounted:function(){var t=this;this.$store.dispatch("modesState/getModes").then(function(){setTimeout(function(){return t.setListeners()},0),setTimeout(function(){return t.setActiveItem()},0)})},methods:{toggleMenu:function(){M()(".column-left").toggleClass("menu__hidden"),M()(".column-content").toggleClass("menu__hidden")},onMenuItemClick:function(t){event.preventDefault(),this.$router.push("/modes?modeId="+t),this.setActiveItem(),this.$store.commit("modesState/SET_CURRENT_MODE",t),768>M()("#app").outerWidth()&&this.toggleMenu()},setListeners:function(){var t=M()(".column-left"),e=0,n=M()(".menu__panel").outerHeight()+M()(".menu__sub-title").outerHeight(),a=M()(".header").outerHeight();M()(".menu--left").css({height:"calc(100vh - ".concat(n+a+16,"px)")}),M()(window).scroll(function(){var s=M()(this).scrollTop();100>s&&t.css({top:"50px"}),2<e-s&&100<s?(t.css({top:"50px"}),M()(".menu--left").css({height:"calc(100vh - ".concat(n+a+16,"px)")})):10<s-e&&100<s&&(t.css({top:"0px"}),M()(".menu--left").css({height:"calc(100vh - (".concat(n+16,"px))")})),e=s})},setActiveItem:function(){this.closeAllItems();var t=this.getURLParameter("modeId"),e=document.getElementById(t);e&&e.classList.add("open")},closeAllItems:function(){var t=document.querySelectorAll(".menu--left .menu__item");for(var e in t){var n=t[e];"object"===Object(y["a"])(n)&&n.classList.remove("open")}},getURLParameter:function(t){for(var e,n=window.location.search.substring(1),a=n.split("&"),s=0;s<a.length;s++)if(e=a[s].split("="),e[0]===t)return e[1];return""}}}),D=L,P=(n("729f"),Object(l["a"])(D,A,I,!1,null,"1bddddf4",null));P.options.__file="ModesMenu.vue";var R=P.exports,U=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[t._m(0),n("message-modal"),n("scheme-modal"),n("add-mode-modal")],1)},V=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("footer",[n("button",{staticClass:"btn",attrs:{"data-toggle":"modal","data-target":"#MessageToDevelopersModal"}},[n("span",[t._v("Оставить отзыв разработчикам")]),n("i",{staticClass:"fab fa-optin-monster"})])])}],z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal fade",attrs:{id:"MessageToDevelopersModal",tabindex:"-1",role:"dialog","aria-labelledby":"MessageToDevelopersModal","aria-hidden":"true"}},[n("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[t._m(0),n("div",{staticClass:"modal-body"},[n("div",{staticClass:"alert alert-danger",attrs:{role:"alert",id:"message-modal-alert"}},[t._v("\n                    Введите корректную тему и сообщение!\n                ")]),n("form",[n("div",{staticClass:"form-group"},[n("label",{staticClass:"col-form-label",attrs:{for:"devs-message-theme"}},[t._v("Тема:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.title,expression:"title"}],staticClass:"form-control bordered",attrs:{type:"text",id:"devs-message-theme",placeholder:"Не больше 200 символов"},domProps:{value:t.title},on:{input:function(e){e.target.composing||(t.title=e.target.value)}}})]),n("div",{staticClass:"form-group"},[n("label",{staticClass:"col-form-label",attrs:{for:"devs-message-text"}},[t._v("Сообщение:")]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"form-control bordered",attrs:{id:"devs-message-text",placeholder:"Не больше 1000 символов"},domProps:{value:t.message},on:{input:function(e){e.target.composing||(t.message=e.target.value)}}})]),n("div",{staticClass:"form-group"},[n("label",{staticClass:"col-form-label",attrs:{for:"devs-message-files"}},[t._v("Изображения:")]),n("input",{ref:"files",staticClass:"form-control bordered",attrs:{type:"file",id:"devs-message-files",multiple:"",accept:"image/*"},on:{change:function(e){t.handleFilesUploads()}}})])])]),n("div",{staticClass:"modal-footer"},[n("button",{staticClass:"btn",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Закрыть")]),n("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.onSendMessage(e)}}},[t._v("Отправить")])])])])])},F=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-header"},[n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]),n("h5",{staticClass:"modal-title"},[t._v(" Отзыв ")]),n("div",[t._v("\n                    Оставляйте здесь любые замечания и пожелания по работе системы и мы исправим их при первой возможности!\n                ")])])}],J=n("bc3a"),H=n.n(J),B={name:"MessageModal",data:function(){return{title:"",message:"",files:""}},methods:{onSendMessage:function(){for(var t,e=new FormData,n=0;n<this.files.length;n++)t=this.files[n],e.append("file"+n,t);e.append("title",this.title),e.append("message",this.message),e.append("url",window.location.pathname),H.a.post("http://localhost:8000/feedback/send-message",e,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}).then(function(){console.log("SUCCESS!!")}).catch(function(){console.log("FAILURE!!")})},handleFilesUploads:function(){this.files=this.$refs.files.files}}},W=B,G=(n("41a4"),Object(l["a"])(W,z,F,!1,null,"1598102b",null));G.options.__file="MessageModal.vue";var Y=G.exports,K=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal fade",attrs:{id:"SchemeModal",tabindex:"-1",role:"dialog","aria-labelledby":"SchemeModal","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-dialog-large",attrs:{role:"document"}},[a("div",{staticClass:"modal-content modal-content-large"},[t._m(0),a("div",{staticClass:"modal-body"},[a("embed",{attrs:{src:n("aa1c"),width:"100%",height:"100%"}})])])])])},q=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-header"},[n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]),n("h5",{staticClass:"modal-title"},[t._v(" Схема цехов ")])])}],Z={name:"SchemeModal"},Q=Z,X=(n("bc57"),Object(l["a"])(Q,K,q,!1,null,"014fcb40",null));X.options.__file="SchemeModal.vue";var tt=X.exports,et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal fade",attrs:{id:"addModeModal",tabindex:"-1",role:"dialog","aria-labelledby":"ModeModal","aria-hidden":"true"}},[n("div",{staticClass:"modal-dialog modal-dialog-large",attrs:{role:"document"}},[n("div",{staticClass:"modal-content modal-content-large"},[t._m(0),n("div",{staticClass:"modal-body"},[n("form",[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"message"}},[t._v("Сообщение")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.currentAddingMode.message,expression:"currentAddingMode.message"}],staticClass:"form-control",attrs:{type:"text",id:"message",placeholder:"Введите сообщение"},domProps:{value:t.currentAddingMode.message},on:{input:function(e){e.target.composing||t.$set(t.currentAddingMode,"message",e.target.value)}}})]),n("div",{staticClass:"form-group",attrs:{id:"plant"}},[n("label",{attrs:{for:"plantName"}},[t._v("Цех")]),n("input",{staticClass:"form-control",attrs:{type:"text",id:"plantName",placeholder:"Введите название цеха",list:"plantList"},on:{input:function(e){return t.onInputChange("plant",e.target.value)}}}),n("datalist",{attrs:{id:"plantList"}},t._l(t.plantList,function(t){return n("option",{key:"plant-"+t.name,domProps:{value:t.verboseName}})}))]),t.currentAddingMode.plant?n("div",{staticClass:"form-group",attrs:{id:"journal"}},[n("label",{attrs:{for:"journalName"}},[t._v("Журнал")]),n("input",{staticClass:"form-control",attrs:{type:"text",id:"journalName",placeholder:"Введите название журнала",list:"journalList"},on:{input:function(e){return t.onInputChange("journal",e.target.value)}}}),n("datalist",{attrs:{id:"journalList"}},t._l(t.journalList,function(t){return n("option",{key:"journal-"+t.name,domProps:{value:t.verboseName}})}))]):t._e(),t.currentAddingMode.plant&&t.currentAddingMode.journal?n("div",{staticClass:"form-group fields-container",attrs:{id:"fields"}},[n("label",[t._v("Поля")]),t.currentAddingMode.fields.length?t._l(t.currentAddingMode.fields,function(e,a){return n("div",{key:a,staticClass:"row field-item"},[n("div",{staticClass:"col"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.verbose_table_name,expression:"item.verbose_table_name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Таблица",list:"table-"+a},domProps:{value:e.verbose_table_name},on:{input:[function(n){n.target.composing||t.$set(e,"verbose_table_name",n.target.value)},function(e){return t.onInputChange("table",e.target.value,a)}]}}),n("datalist",{attrs:{id:"table-"+a}},t._l(t.tableList,function(t){return n("option",{key:"table-"+t.name+"-"+a,domProps:{value:t.name}})}))]),n("div",{staticClass:"col"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.verbose_name,expression:"item.verbose_name"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Ячейка",list:"cell-"+a},domProps:{value:e.verbose_name},on:{input:[function(n){n.target.composing||t.$set(e,"verbose_name",n.target.value)},function(e){return t.onInputChange("field",e.target.value,a)}]}}),e["table_name"]?n("datalist",{attrs:{id:"cell-"+a}},t._l(t.fieldList,function(t){return n("option",{key:"field-"+t.name+"-"+a,domProps:{value:t.name}})})):t._e()]),n("div",{staticClass:"col"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e["min_normal"],expression:"item['min_normal']"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Мин. значение"},domProps:{value:e["min_normal"]},on:{input:function(n){n.target.composing||t.$set(e,"min_normal",n.target.value)}}})]),n("div",{staticClass:"col"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e["max_normal"],expression:"item['max_normal']"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Макс. значение"},domProps:{value:e["max_normal"]},on:{input:function(n){n.target.composing||t.$set(e,"max_normal",n.target.value)}}})]),n("div",{staticClass:"delete-icon",on:{click:function(e){t.onDeleteField(a)}}},[n("i",{staticClass:"fas fa-times"})])])}):n("p",{staticClass:"no-fields-text"},[t._v("Нет полей")])],2):t._e(),t.currentAddingMode.plant&&t.currentAddingMode.journal?n("div",{staticClass:"btns"},[n("button",{staticClass:"btn",attrs:{"data-target":"mode-cell-add"},on:{click:function(e){return e.preventDefault(),t.onAddField(e)}}},[t._v("Добавить поле")]),n("button",{staticClass:"btn",attrs:{"data-target":"mode-add"},on:{click:function(e){return e.preventDefault(),t.onAddMode(e)}}},[t._v("Сохранить")])]):t._e()])])])])])},nt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-header"},[n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]),n("h5",{staticClass:"modal-title"},[t._v(" Добавление режима ")])])}],at=H.a.create({withCredentials:!0});at.interceptors.response.use(void 0,function(t){return t.response&&(401===t.response.status||403===t.response.status)&&_a.push("/login"),Promise.reject(t.response.data)});var st=at,ot=n("8dee"),it=n.n(ot),rt={name:"AddModeModal",data:function(){return{plantList:[],journalList:[],tableList:[],fieldList:[],randomIds:[],currentAddingMode:{message:"",plant:"",journal:"",fields:[]}}},methods:{getRandomId:function(t){return this.randomIds.filter(function(e){return e.index===t})[0].id},onAddMode:function(){var t=this;this.$store.dispatch("modesState/addMode",{mode:this.currentAddingMode}).then(function(){$("#addModeModal button.close").trigger("click")}).then(function(){t.$store.dispatch("modesState/getModes")})},onAddField:function(){this.currentAddingMode.fields.push({table_name:"",verbose_table_name:"",name:"",verbose_name:"",min_normal:"",max_normal:""}),this.tableList=[],this.fieldList=[]},onDeleteField:function(t){this.currentAddingMode.fields=this.currentAddingMode.fields.filter(function(e,n){return n!==t})},getExistingName:function(t,e){var n=this[t].filter(function(t){return t.name===e})[0];return n?n.name:void 0},getNameByVerboseName:function(t,e){var n=this[t].filter(function(t){return t.verboseName===e})[0];return n?n.name:void 0},onInputChange:function(t,e,n){var a=this;"plant"===t?this.getPlants().then(function(){a.getNameByVerboseName("plantList",e)?a.currentAddingMode.plant=a.getNameByVerboseName("plantList",e):(a.currentAddingMode.plant="",a.journalList=[],a.tableList=[],a.fieldList=[])}):"journal"===t?this.getJournals(this.currentAddingMode.plant).then(function(){a.getNameByVerboseName("journalList",e)?a.currentAddingMode.journal=a.getNameByVerboseName("journalList",e):(a.currentAddingMode.journal="",a.tableList=[],a.fieldList=[])}):"table"===t?this.getTables(this.currentAddingMode.plant,this.currentAddingMode.journal).then(function(){a.getExistingName("tableList",e)?a.currentAddingMode.fields[n].table_name=e:(a.currentAddingMode.fields[n].table_name="",a.fieldList=[])}):"field"==t&&this.currentAddingMode.fields[n].table_name&&this.getFields(this.currentAddingMode.plant,this.currentAddingMode.journal,this.currentAddingMode.fields[n].table_name).then(function(){a.currentAddingMode.fields[n].name=a.getExistingName("fieldList",e)?e:""})},getPlants:function(){var t=this;return st.get(window.HOSTNAME+"/api/plants/",{withCredentials:!0}).then(function(e){t.plantList=e.data}).catch(function(t){console.log(t)})},getJournals:function(t){var e=this;return st.get(window.HOSTNAME+"/api/journals/?plant=".concat(t),{withCredentials:!0}).then(function(t){e.journalList=t.data}).catch(function(t){console.log(t)})},getTables:function(t,e){var n=this;return st.get(window.HOSTNAME+"/api/tables/?plant=".concat(t,"&journal=").concat(e),{withCredentials:!0}).then(function(t){n.tableList=t.data}).catch(function(t){console.log(t)})},getFields:function(t,e,n){var a=this;return st.get(window.HOSTNAME+"/api/fields/?plant=".concat(t,"&journal=").concat(e,"&table=").concat(n),{withCredentials:!0}).then(function(t){a.fieldList=t.data}).catch(function(t){console.log(t)})}},mounted:function(){var t=this;this.currentAddingMode.fields.map(function(e,n){t.randomIds.push({index:n,id:it.a.generate()})})}},lt=rt,ct=(n("d46a"),Object(l["a"])(lt,et,nt,!1,null,"790d465e",null));ct.options.__file="AddModeModal.vue";var ut=ct.exports,dt={name:"Footer",components:{"message-modal":Y,schemeModal:tt,"add-mode-modal":ut}},mt=dt,ft=(n("4772"),Object(l["a"])(mt,U,V,!1,null,"b7bf97bc",null));ft.options.__file="Footer.vue";var pt=ft.exports,ht=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},vt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"popper"},[n("span",{staticClass:"popper__arrow"}),n("span",{staticClass:"close"},[t._v("×")]),n("textarea",{staticClass:"content"},[t._v("...")])])}],gt={name:"Popup"},_t=gt,bt=(n("61c8"),Object(l["a"])(_t,ht,vt,!1,null,"167c8e88",null));bt.options.__file="Popup.vue";var Ct=bt.exports,jt={name:"BasePage",components:{"top-nav":S,"left-menu":O,"modes-left-menu":R,"main-footer":pt,popup:Ct},methods:{},mounted:function(){}},St=jt,xt=(n("940c"),Object(l["a"])(St,p,h,!1,null,"e46f4f1e",null));xt.options.__file="BasePage.vue";var wt=xt.exports,yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.classes},[t.config_flag?n("span",[t._v(" "+t._s(t.message)+" ")]):n("grid-layout",{attrs:{layout:t.layout,"col-num":12,"row-height":30,"is-draggable":t.draggable,"is-resizable":t.resizable,"vertical-compact":!0,"use-css-transforms":!0},on:{"layout-updated":t.layoutUpdatedEvent}},t._l(t.config,function(e){return n("grid-item",{key:e.i,attrs:{x:e.x,y:e.y,w:e.w,h:e.h,i:e.i,id:"vue-grid-item-"+e.i,"drag-ignore-from":t.dragIgnoreFrom},on:{resized:t.resizedEvent}},[n("Graph",{attrs:{idx:e.i,type:e.type}}),n("button",{directives:[{name:"show",rawName:"v-show",value:!t.config_flag,expression:"!config_flag"}],staticClass:"delete-btn",on:{click:function(n){t.deleteGraph(e.i)}}},[t._v("Delete")])],1)}))],1)},Nt=[],Mt=(n("ac6a"),n("8615"),n("7be8")),$t=n.n(Mt),Et=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:t.idx}},[t._v("\n    "+t._s(t.message)+"\n")])},kt=[],Tt=n("61cc"),Ot=n.n(Tt),At={name:"Graph",props:["idx","type"],data:function(){return{message:"Loading graph..."}},methods:{render:function(t){console.log(t),this.message="";var e=this.idx,n=M()("#vue-grid-item-"+e).width(),a=M()("#vue-grid-item-"+e).height();console.log(n,a),t.layout.width=n,t.layout.height=a-30,Ot.a.newPlot(e,t.data,t.layout)},get_data:function(){var t=this,e={id:this.idx,type:this.type};console.log(e),st.post(window.HOSTNAME+"/dashboard/get-graph-data/",e,{withCredentials:!0}).then(function(e){t.render(e.data)})}},created:function(){this.get_data()}},It=At,Lt=(n("8e60"),Object(l["a"])(It,Et,kt,!1,null,null,null));Lt.options.__file="Graph.vue";var Dt=Lt.exports,Pt=$t.a.GridLayout,Rt=$t.a.GridItem,Ut={name:"Dashboard",components:{GridLayout:Pt,GridItem:Rt,Graph:Dt},data:function(){return{classes:"dashboard",config:null,message:"Loading dashboard config...",config_flag:!0,draggable:!0,resizable:!0,dragIgnoreFrom:".plotly, .delete-btn",index:0}},computed:{layout:function(){return Object.values(this.config)}},methods:{layoutUpdatedEvent:function(t){console.log(t),st.post(window.HOSTNAME+"/dashboard/update-config",t,{withCredentials:!0})},resizedEvent:function(t,e,n,a,s){Ot.a.relayout(t,{autosize:!1,width:s-4,height:a-30})},deleteGraph:function(t){console.log("deleting "+t),st.post(window.HOSTNAME+"/dashboard/delete-graph",{id:t},{withCredentials:!0}),Vue.delete(this.config,t),M.a.isEmptyObject(this.config)&&(this.message="There is no data",this.config_flag=!0)}},mounted:function(){var t=this;st.get("http://"+window.location.hostname+":8000/dashboard/get-config",{withCredentials:!0}).then(function(e){if(console.log(e.data),M.a.isEmptyObject(e.data.config))t.message="There is no data";else{for(var n in t.config=e.data.config,t.config){var a=t.config[n];a.i=n}t.config_flag=!1,console.log(t)}})}},Vt=Ut,zt=(n("2fe3"),Object(l["a"])(Vt,yt,Nt,!1,null,null,null));zt.options.__file="Dashboard.vue";var Ft=zt.exports,Jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("main",{staticClass:"journal-page"},[n("div",{staticClass:"journal-title"},["defaultJournalPage"===t.$route.name?n("h4",{staticClass:"journal_title"},[t._v(t._s(t.$store.getters["journalState/journalVerboseName"]))]):t._e(),n("button",{staticClass:"btn btn-outline",on:{click:t.openConstructor}},[t._v("\n            Открыть в конструкторе\n        ")])]),n("journal-panel"),n("article",{staticClass:"journal-tables"},[t.$store.getters["journalState/loaded"]?t._l(t.$store.getters["journalState/tables"],function(e,a){return n("tablecommon",{key:t.$store.getters["journalState/journalName"]+"_"+e,attrs:{name:e,index:a}})}):[n("span",[t._v("Нет данных")])]],2)],1)},Ht=[],Bt=(n("7514"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-popover",{staticStyle:{height:"100%"},attrs:{offset:"16",disabled:"validate"!==t.mode}},[n("input",{directives:[{name:"tooltip",rawName:"v-tooltip",value:{content:t.tooltipContent,show:t.showTooltip,trigger:"manual"},expression:"{content: tooltipContent, show: showTooltip, trigger: 'manual'}"}],class:["general-value","number-cell","form-control","edit"===t.mode?"form-control__edit":""],style:[{color:t.activeColor,fontWeight:t.fontWeight}],attrs:{name:t.fieldName,"row-index":t.rowIndex,readonly:"edit"!==t.mode||t.hasFormula,placeholder:t.placeholder,type:t.type},domProps:{value:t.value},on:{keypress:t.filterInput,keydown:t.changeFocus,change:t.onChanged,input:t.onInput,blur:function(e){t.showTooltip=!1},contextmenu:function(e){return e.preventDefault(),t.$refs.menu.open(e)}}}),n("div",{staticClass:"widthCell"}),[t.personsList?n("datalist",t._l(t.personsList,function(t){return n("option",{domProps:{value:t}})})):t._e()],t.$store.getters["journalState/cellComments"](t.tableName,t.fieldName,t.rowIndex).length?n("i",{staticClass:"far fa-envelope comment-notification"}):t._e(),n("template",{slot:"popover"},[n("CellComment",{attrs:{"table-name":t.tableName,"field-name":t.fieldName,"row-index":t.rowIndex}})],1),n("vue-context",{ref:"menu"},[n("ul",[n("li",{on:{click:function(e){t.deleteRow()}}},[t._v("Удалить строку")]),n("li",{on:{click:function(e){t.addRow()}}},[t._v("Добавить строку")]),n("li",{on:{click:function(e){t.flushRow()}}},[t._v("Очистить строку")])])])],2)}),Wt=[],Gt=n("e37d"),Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"cell-popup tooltip-content"},[n("div",{staticClass:"header"},[n("i",{directives:[{name:"close-popover",rawName:"v-close-popover"}],staticClass:"btn--close fas fa-times"}),n("div",{staticClass:"title"},[t._v("\n      "+t._s(t.$store.getters["journalState/tableVerboseName"](t.tableName))+"\n    "),n("br"),t._v("\n      "+t._s(t.$store.getters["journalState/fieldVerboseName"](t.tableName,t.fieldName))+"\n    ")]),t._m(0)]),n("div",{staticClass:"body"},[n("ul",{staticClass:"list"},[t.cellValue?n("li",{staticClass:"item"},[n("i",{staticClass:"item__icon fas fa-pencil-alt"}),n("span",{staticClass:"item__text"},[t._v(t._s(t.cellValue))])]):t._e(),t.cellCreatedTime?n("li",{staticClass:"item"},[n("i",{staticClass:"item__icon far fa-clock"}),n("span",{staticClass:"item__text"},[t._v(t._s(t.cellCreatedTime))])]):t._e(),t.minNormal||t.maxNormal?n("li",{staticClass:"item"},[n("i",{staticClass:"item__icon fas fa-info-circle"}),n("span",{staticClass:"item__text"},[t._v("Допустимые значения "),t.minNormal?[t._v("от "+t._s(t.minNormal)+" ")]:t._e(),t.maxNormal?[t._v(" до "+t._s(t.maxNormal))]:t._e()],2)]):t._e(),t.responsible?n("li",{staticClass:"item"},[n("i",{staticClass:"item__icon fas fa-user-tie"}),n("span",{staticClass:"item__text"},[t._v(t._s(t.responsible))])]):t._e(),t.cellCreatedDate?n("li",{staticClass:"item"},[n("i",{staticClass:"item__icon fas fa-calendar-alt"}),n("span",{staticClass:"item__text"},[t._v(t._s(t.cellCreatedDate))])]):t._e()]),n("ul",{staticClass:"comments"},t._l(t.comments,function(e){return n("li",[n("div",{staticStyle:{float:"left"}},[n("b",[t._v(t._s(Object.values(e.user)[0]))]),t._v(" ("+t._s(t.prettyDate(e.created))+"):")]),t._v(" "+t._s(e.text)+"\n      ")])})),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.commentText,expression:"commentText"}],staticStyle:{width:"80%"},domProps:{value:t.commentText},on:{input:function(e){e.target.composing||(t.commentText=e.target.value)}}}),n("br"),n("button",{staticClass:"btn",on:{click:t.addComment}},[t._v("Добавить комментарий")]),n("br"),n("br"),n("div",{staticClass:"buttons-panel"},[n("div",{staticClass:"dropdown"},[t._m(1),n("div",{staticClass:"dropdown-menu",attrs:{"aria-labelledby":"dropdownMenuButton"}},[n("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(e){t.addToDashboard("ShiftTimeline")}}},[t._v("ShiftTimeline")]),n("a",{staticClass:"dropdown-item",attrs:{href:"#"},on:{click:function(e){t.addToDashboard("ShiftHistogram")}}},[t._v("ShiftHistogram")])])])])])])},Kt=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header__icon"},[n("i",{staticClass:"fas fa-receipt"})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{staticClass:"btn btn-secondary dropdown-toggle",attrs:{type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[n("i",{staticClass:"fas fa-chart-line"}),t._v("\n              Построить график\n            ")])}],qt={name:"CellComment",props:["tableName","fieldName","rowIndex"],data:function(){return{commentText:""}},computed:{cellValue:function(){return this.$store.getters["journalState/cell"](this.tableName,this.fieldName,this.rowIndex).value},cellCreatedDate:function(){var t=this.$store.getters["journalState/cell"](this.tableName,this.fieldName,this.rowIndex).created;if(t){var e=new Date(t);return e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()}return""},cellCreatedTime:function(){var t=this.$store.getters["journalState/cell"](this.tableName,this.fieldName,this.rowIndex).created;if(t){var e=new Date(t);return e.getHours()+":"+(10>e.getMinutes()?"0":"")+e.getMinutes()}return""},responsible:function(){var t=this.$store.getters["journalState/cell"](this.tableName,this.fieldName,this.rowIndex).responsible;return t?Object.values(t)[0]:""},minNormal:function(){return this.$store.getters["journalState/fieldDescription"](this.tableName,this.fieldName).min_normal},maxNormal:function(){return this.$store.getters["journalState/fieldDescription"](this.tableName,this.fieldName).max_normal},units:function(){return this.$store.getters["journalState/fieldDescription"](this.tableName,this.fieldName).units},comments:function(){return this.$store.getters["journalState/cellComments"](this.tableName,this.fieldName,this.rowIndex)}},methods:{prettyDate:function(t){return t=new Date(t),t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},addComment:function(){var t=new Date;this.$store.commit("journalState/SAVE_CELL_COMMENT",{tableName:this.tableName,fieldName:this.fieldName,index:this.rowIndex,comment:{text:this.commentText,created:t.toISOString(),user:{self:this.$store.getters["userState/username"]}}}),this.send()},send:function(){this.$socket.sendObj({type:"messages",cell_location:{group_id:this.$store.getters["journalState/journalInfo"].id,table_name:this.tableName,field_name:this.fieldName,index:this.rowIndex},message:{text:this.commentText,link:"lalala",type:"comment"},crud:"add"})},addToDashboard:function(t){st.post(window.HOSTNAME+"/dashboard/add-graph",{cell_info:{journal_name:this.$store.state.journalState.journalInfo.journal.name,table_name:this.tableName,field_name:this.fieldName},graph_info:{type:t}},{withCredentials:!0})}}},Zt=qt,Qt=(n("5092"),Object(l["a"])(Zt,Yt,Kt,!1,null,null,null));Qt.options.__file="CellComment.vue";var Xt=Qt.exports,te=n("9175");n("45e9");a["a"].directive("tooltip",Gt["c"]),a["a"].directive("close-popover",Gt["a"]),a["a"].component("v-popover",Gt["b"]),a["a"].component("vue-context",te["VueContext"]),a["a"].component("CellComment",Xt);var ee={name:"Cell",props:["fieldName","rowIndex","linked"],data:function(){return{classes:"general-value number-cell form-control",minValue:null,maxValue:null,type:null,placeholder:"",showTooltip:!1,personsList:null,tooltipContent:"",fontWeight:"lighter",minWidth:0}},watch:{mode:function(){var t=this;setTimeout(function(){return t.setPickersListeners()},1)},value:function(){if(this.responsible&&!(this.$store.getters["userState/username"]in this.responsible)){this.fontWeight="bold",this.tooltipContent=Object.values(this.responsible)[0]+" печатает...",this.showTooltip=!0;var t=this;setTimeout(function(){t.showTooltip=!1,t.fontWeight="lighter"},1500)}}},computed:{tableName:function(){return"undefined"==typeof this.$parent.props?"":this.$parent.props.name},activeColor:function(){return"number"===this.type&&this.critical?"red":""},critical:function(){return this.minValue&&this.value<this.minValue||this.maxValue&&this.value>this.maxValue},responsible:function(){return this.$store.getters["journalState/cell"](this.tableName,this.fieldName,this.rowIndex).responsible},value:{cache:!1,get:function(){return this.$store.getters["journalState/cell"](this.tableName,this.fieldName,this.rowIndex).value},set:function(t){this.$store.commit("journalState/SET_SYNCHRONIZED",navigator.onLine),this.$store.commit("journalState/SAVE_CELLS",{cells:[{tableName:this.tableName,fieldName:this.fieldName,index:this.rowIndex,value:t,notSynchronized:!navigator.onLine}]})}},hasFormula:function(){return!!this.$store.getters["journalState/fieldFormula"](this.tableName,this.fieldName)},mode:function(){return this.$store.getters["journalState/journalInfo"].mode}},methods:{deleteRow:function(){this.$store.commit("journalState/DELETE_TABLE_ROW",{tableName:this.tableName,index:this.rowIndex,maxRowIndex:this.$store.getters["journalState/maxRowIndex"](this.tableName)}),this.$store.dispatch("journalState/sendJournalData")},addRow:function(){this.$store.commit("journalState/INSERT_EMPTY_TABLE_ROW",{tableName:this.tableName,index:this.rowIndex,maxRowIndex:this.$store.getters["journalState/maxRowIndex"](this.tableName)}),this.$store.dispatch("journalState/sendJournalData")},flushRow:function(){this.$store.commit("journalState/FLUSH_TABLE_ROW",{tableName:this.tableName,index:this.rowIndex,maxRowIndex:this.$store.getters["journalState/maxRowIndex"](this.tableName)}),this.$store.dispatch("journalState/sendJournalData")},setPickersListeners:function(){var t=this;if("time"===this.type&&("edit"===this.mode?$(this.$el).find("input").clockpicker({autoclose:!0,default:"now",donetext:!1,afterDone:function(){t.value=$(t.$el).find("input").val()}}):$(this.$el).find("input").clockpicker("remove")),"date"===this.type&&("edit"===this.mode?$(this.$el).find("input").datepicker({format:"yyyy-mm-dd",autoclose:!0,endDate:"+0d"}).on("changeDate",function(){t.value=$(t.$el).find("input").val()}):$(this.$el).find("input").datepicker("destroy")),"Фамилия И.О."===$(this.$el).find("input").attr("placeholder")){var e=it.a.generate();$(this.$el).find("input").attr("list",e),$(this.$el).find("datalist").attr("id",e)}},getPersons:function(t){return st.get("http://127.0.0.1:8000/api/autocomplete/?name=".concat(t),{withCredentials:!0}).catch(function(t){console.log(t)})},send:function(){this.$socket.sendObj({type:"shift_data",cells:[{cell_location:{group_id:this.$store.getters["journalState/journalInfo"].id,table_name:this.tableName,field_name:this.fieldName,index:this.rowIndex},value:this.value}]})},onInput:function(t){var e=this;$(this.$el).find(".widthCell").text(t.target.value),$(this.$el).find("input").css({"min-width":$(this.$el).find(".widthCell").outerWidth()}),this.value=t.target.value,"Фамилия И.О."===$(this.$el).find("input").attr("placeholder")&&this.getPersons(t.target.value).then(function(t){e.personsList=t.data}),this.send()},onChanged:function(t){t.preventDefault(),this.critical?(console.log("critical"),this.$socket.sendObj({type:"messages",cell:{field_name:this.fieldName,table_name:this.tableName,group_id:this.$store.getters["journalState/journalInfo"].id,index:this.rowIndex},crud:"add",message:{text:this.value,link:"lalala",type:"critical_value"}})):(console.log("non critical"),this.$socket.sendObj({type:"messages",cell:{field_name:this.fieldName,table_name:this.tableName,group_id:this.$store.getters["journalState/journalInfo"].id,index:this.rowIndex},crud:"update"}),this._updateCells())},filterInput:function(t){if("number"===this.type){var e=t.which;0==t.shiftKey&&(45==e&&""==this.value||46==e||8==e||37==e||39==e||48<=e&&57>=e)?this.showTooltip=!1:(this.tooltipContent="Введите число",this.showTooltip=!0,event.preventDefault())}},changeFocus:function(t){function e(t,e){for(var n,a=0,s=0;s<t.length;s++){if(n=t[s],a===e)return n;a+=parseInt(n.getAttribute("colspan"),10)||1}}var n=this.$el.parentElement,a=n.parentElement,s=function(t,e){for(var n,a=0,s=0;s<t.length&&(n=t[s],n!==e);s++)a+=parseInt(n.getAttribute("colspan"),10)||1;return a}(a.children,n);switch(t.key){case"ArrowUp":event.preventDefault();var o=a.previousElementSibling;o&&e(o.children,s).children[0].children[0].children[0].select();break;case"ArrowDown":event.preventDefault();var i=a.nextElementSibling;i&&e(i.children,s).children[0].children[0].children[0].select();break;case"ArrowLeft":event.preventDefault();var r=n.previousElementSibling;r&&r.children[0].children[0].children[0].select();break;case"ArrowRight":event.preventDefault();var l=n.nextElementSibling;l&&l.children[0].children[0].children[0].select()}},_updateCells:function(){var t=this.$parent.$parent.$parent;for(var e in t.$children){var n=t.$children[e],a=n.$children[0];for(var s in a.$children){var o=a.$children[s];o.$forceUpdate()}}}},mounted:function(){var t=this,e=this.$store.getters["journalState/fieldDescription"](this.tableName,this.fieldName);this.placeholder=e.units||"",this.minValue=e.min_normal||null,this.maxValue=e.max_normal||null,this.type=e.type||"text",this.$root.$on("send",function(){t.send()}),this.linked&&(this.value=this.$store.getters["journalState/"+this.linked],this.send()),setTimeout(function(){return $(t.$el).find("input").css({"min-width":$(t.$el).find(".widthCell").text(t.value).outerWidth()+"px"})},0),setTimeout(function(){return t.setPickersListeners()},1)}},ne=ee,ae=(n("7ea3"),Object(l["a"])(ne,Bt,Wt,!1,null,null,null));ae.options.__file="Cell.vue";var se=ae.exports,oe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"table__comment"},[n("a",{attrs:{href:"javascript:;"},on:{click:t.onClick}},[t._v("Комментарий ")]),n("i",{staticClass:"fas fa-envelope ico-comment"}),n("div",{class:["comment__text",{collapse:t.isCollapsed}]},[n("textarea",{staticClass:"table-comment",attrs:{placeholder:"Комментарий...",title:""},domProps:{value:t.text},on:{input:t.onInput}})])])},ie=[],re={name:"table-comment",props:["tableName"],data:function(){return{rowIndex:"0",isCollapsed:!0,fieldName:"__table__comment"}},watch:{text:function(t){this.isCollapsed=!t}},computed:{text:{get:function(){return this.$store.getters["journalState/cell"](this.tableName,this.fieldName,this.rowIndex).value},set:function(t){this.$store.commit("journalState/SAVE_CELLS",{cells:[{tableName:this.tableName,fieldName:this.fieldName,index:this.rowIndex,value:t}]})}}},methods:{onInput:function(t){this.text=t.target.value,this.send()},onClick:function(){this.isCollapsed=!this.isCollapsed},send:function(){this.$socket.sendObj({type:"shift_data",cells:[{cell_location:{group_id:this.$store.getters["journalState/journalInfo"].id,table_name:this.tableName,field_name:this.fieldName,index:this.rowIndex},value:this.text||""}]})}},mounted:function(){this.text&&(this.isCollapsed=!1)}},le=re,ce=Object(l["a"])(le,oe,ie,!1,null,null,null);ce.options.__file="TableComment.vue";var ue=ce.exports,de=n("f206"),me=n.n(de),fe=n("2f62"),pe=n("bfa9"),he=(n("456d"),{namespaced:!0,state:{plantsInfo:[],journalInfo:{},events:[],loaded:!1,socket:{isConnected:!1,reconnectError:!1},isSynchronized:!0},getters:{loaded:function(t){return t.loaded},journalInfo:function(t){return t.journalInfo},events:function(t){return t.events},currentMode:function(t){return t.loaded?t.journalInfo.journal.mode:""},tables:function(t){return t.loaded?Object.keys(t.journalInfo.journal.tables):[]},isSynchronized:function(t){return t.isSynchronized},plants:function(t){return t.plantsInfo},plantName:function(t){return t.loaded?t.journalInfo.plant.name:""},plantVerboseName:function(t){return t.loaded?t.plantsInfo.filter(function(e){return e.name===t.journalInfo.plant.name})[0].verbose_name:""},journalName:function(t){return t.loaded?t.journalInfo.journal.name:""},journalVerboseName:function(t,e){if(t.loaded){var n=e.plantName;return t.plantsInfo.filter(function(t){return t.name===n})[0].journals.filter(function(e){return e.name===t.journalInfo.journal.name})[0].verbose_name}return""},tableVerboseName:function(t){return function(e){return t.loaded?e:""}},fieldVerboseName:function(t){return function(e,n){return t.loaded?n:""}},shiftOrder:function(t){return t.loaded?t.journalInfo.order:-1},cell:function(t){return function(e,n,a){if(t.loaded){var s=t.journalInfo.journal.tables[e].fields;if(!(n in s))return{};var o=s[n];if(o.formula)return{value:window.parser.parse(o.formula).result};var i=o.cells;return 0===Object.keys(i).length?{}:a in i?i[a]:{}}}},cellComments:function(t){return function(e,n,a){if(t.loaded){var s=t.journalInfo.journal.tables[e].fields;if(!(n in s))return[];var o=s[n].cells;return 0===Object.keys(o).length?[]:a in o&&o[a].comments||[]}}},fieldCells:function(t){return function(e,n){if(t.loaded){var a=t.journalInfo.journal.tables[e].fields;return n in a?t.journalInfo.journal.tables[e].fields[n].cells:[]}return[]}},unsyncJournalCells:function(t,e){return function(){var n=[];return e.tables.map(function(e){var a=t.journalInfo.journal.tables[e];for(var s in a.fields){var o=a.fields[s].cells;for(var i in o)o[i].notSynchronized&&n.push(o[i])}}),n}},maxRowIndex:function(t){return function(e){if(t.loaded){var n=-1,a=t.journalInfo.journal.tables[e].fields;for(var s in a)for(var o in a[s].cells)o=parseInt(o),a[s].cells[o].value&&"__table__comment"!=s&&(n=n<o?o:n);return n+1}return-1}},rowIsEmpty:function(t){return function(e,n){if(t.loaded){var a=t.journalInfo.journal.tables[e].fields;for(var s in a)if("cells"in a[s]&&n in a[s].cells)return!1;return!0}}},tableTitle:function(){return function(){return"Заголовок таблицы"}},fieldDescription:function(t){return function(e,n){if(t.loaded){var a=t.journalInfo.journal.tables[e].fields;return n in a?a[n].field_description||"":{}}return""}},fieldFormula:function(t){return function(e,n){if(t.loaded){var a=t.journalInfo.journal.tables[e].fields;return n in a?a[n].formula||"":{}}return""}}},mutations:{SET_SYNCHRONIZED:function(t,e){t.isSynchronized=e},UPDATE_JOURNAL_INFO:function(t,e){t.journalInfo=e},UPDATE_PLANTS_INFO:function(t,e){t.plantsInfo=e},SET_LOADED:function(t,e){t.loaded=e},SAVE_CELLS:function(t,e){if(t.loaded){var n=e.cells;for(var a in n){var s=t.journalInfo.journal.tables[n[a].tableName].fields;n[a].fieldName in s||(Vue.set(s,n[a].fieldName,{}),Vue.set(s[n[a].fieldName],"cells",{}));var o=s[n[a].fieldName].cells;n[a].index in o?(o[n[a].index].value=n[a].value,Vue.set(o[n[a].index],"responsible",n[a].responsible),n[a].notSynchronized&&(o[n[a].index].notSynchronized=n[a].notSynchronized,o[n[a].index].fieldName=n[a].fieldName,o[n[a].index].tableName=n[a].tableName,o[n[a].index].index=n[a].index)):(Vue.set(o,n[a].index,{}),Vue.set(o[n[a].index],"value",n[a].value),Vue.set(o[n[a].index],"responsible",n[a].responsible),n[a].notSynchronized&&Vue.set(o[n[a].index],"notSynchronized",n[a].notSynchronized))}}},SAVE_CELL_COMMENT:function(t,e){if(t.loaded){var n=t.journalInfo.journal.tables[e.tableName].fields;e.fieldName in n||(n[e.fieldName]={},n[e.fieldName].cells={});var a=n[e.fieldName].cells;e.comment?e.index in a?(!("comments"in a[e.index])&&Vue.set(a[e.index],"comments",[]),a[e.index].comments.push(e.comment)):(Vue.set(a,e.index,{comments:[]}),a[e.index].comments.push(e.comment)):Vue.delete(a,e.index)}},SET_PAGE_MODE:function(t,e){t.loaded&&(t.journalInfo.mode=e)},DELETE_TABLE_ROW:function(t,e){if(t.loaded){var n=t.journalInfo.journal.tables[e.tableName].fields;for(var a in n)if("cells"in n[a])for(var s=n[a].cells,o=0;o<=e.maxRowIndex;o++)o==e.index&&Vue.set(s,o,{value:""}),o>e.index&&s[o]&&(Vue.set(s,o-1,s[o]),Vue.set(s,o,{value:""}))}},INSERT_EMPTY_TABLE_ROW:function(t,e){if(t.loaded){var n=t.journalInfo.journal.tables[e.tableName].fields;for(var a in n)if("cells"in n[a])for(var s=n[a].cells,o=e.maxRowIndex;0<=o;o--)o>=e.index&&s[o]&&(Vue.set(s,o+1,s[o]),Vue.set(s,o,{value:""})),o==e.index&&Vue.set(s,o,{value:""})}},FLUSH_TABLE_ROW:function(t,e){if(t.loaded){var n=t.journalInfo.journal.tables[e.tableName].fields;for(var a in n)if("cells"in n[a])for(var s=n[a].cells,o=e.maxRowIndex;0<=o;o--)o==e.index&&Vue.set(s,o,{value:""})}},SOCKET_ONOPEN:function(t,e){Vue.prototype.$socket=e.currentTarget,t.socket.isConnected=!0},SOCKET_ONCLOSE:function(t){t.socket.isConnected=!1},SOCKET_ONERROR:function(t,e){console.error(t,e)},SOCKET_ONMESSAGE:function(){},SOCKET_RECONNECT:function(t,e){console.info(t,e)},SOCKET_RECONNECT_ERROR:function(t){t.socket.reconnectError=!0}},actions:{sendJournalData:function(t){t.commit;var e=t.state,n=t.getters,a={type:"shift_data",cells:[]},s=e.journalInfo.journal.tables;for(var o in s){var i=s[o].fields;for(var r in i){var l=i[r].cells;for(var c in l)a.cells.push({cell_location:{group_id:n.journalInfo.id,table_name:o,field_name:r,index:c},value:l[c].value})}}window.mv.$socket.sendObj(a)},loadJournal:function(t,e){var n=t.commit,a=(t.state,t.getters),s=e.id?e.id:"";return st.get(window.HOSTNAME+"/api/shifts/"+s,{params:{plantName:e.plantName,journalName:e.journalName}}).then(function(t){return n("UPDATE_JOURNAL_INFO",a.isSynchronized?t.data:JSON.parse(localStorage.getItem("vuex")).journalState.journalInfo),n("SET_LOADED",!0),t.data.id}).catch(function(t){console.log(t)})},loadPlants:function(t){var e=t.commit;t.state,t.getters;st.get(window.HOSTNAME+"/api/menu_info/").then(function(t){e("UPDATE_PLANTS_INFO",t.data.plants)})},loadShifts:function(t,e){t.commit;var n=t.state;t.getters;return st.get(window.HOSTNAME+"/"+e.plant+"/"+e.journal+"/get_shifts/").then(function(t){n.events=t.data,$(".fc-month-button").click()}).catch(function(t){console.log(t)})},sendUnsyncCell:function(t,e){t.commit,t.state;var n=t.getters;window.mv.$socket.sendObj({type:"shift_data",cell_location:{group_id:n.journalInfo.id,table_name:e.tableName,field_name:e.fieldName,index:e.index},value:e.value})}}}),ve=he,ge={namespaced:!0,state:{user:null},getters:{user:function(t){return t.user},username:function(t){return t.user?t.user.username:""}},mutations:{SET_USER:function(t,e){t.user=e}},actions:{login:function(t,e){var n=t.commit;t.state,t.getters;return new Promise(function(t,a){st.post("http://"+window.location.hostname+":8000/api/auth/token/login/",{username:e.username,password:e.password}).then(function(e){st.get("http://"+window.location.hostname+":8000/api/auth/users/me",{headers:{Authorization:"Token "+e.data.auth_token}}).then(function(t){n("SET_USER",t.data)}).then(function(){f.a.set("Authorization",e.data.auth_token,1/0)}).then(function(){t()}).catch(function(t){a(t)})}).catch(function(t){a(t)})})},logout:function(t){var e=t.commit;t.state,t.getters;return new Promise(function(t){st.post("http://"+window.location.hostname+":8000/api/auth/token/logout/",null,{headers:{Authorization:"Token "+f.a.get("Authorization")}}).then(function(){e("SET_USER",null)}).then(function(){f.a.set("Authorization","")}).then(function(){t()})})}}},_e=ge,be=(n("2b0e"),{namespaced:!0,state:{modes:[],currentMode:null},getters:{modes:function(t){return t.modes},currentMode:function(t){return t.currentMode},currentModeById:function(t){return function(e){return t.modes.filter(function(t){return t.id==e})[0]}}},mutations:{SET_MODES:function(t,e){t.modes=e},ADD_MODES:function(t,e){t.modes.push(e)},SET_CURRENT_MODE:function(t,e){t.currentMode=e?t.modes.filter(function(t){return t.id==e})[0]:null},UPDATE_CURRENT_MODE:function(t,e){t.currentMode=e},CHANGE_CELL_VALUE:function(t,e){var n=JSON.parse(JSON.stringify(t.currentMode));n.fields=n.fields.map(function(t){return t.table_name===e.tableName&&t.name===e.name?(t[e.dataType]=+e.value,t):t}),t.currentMode=n},DELETE_CELL:function(t,e){var n=JSON.parse(JSON.stringify(t.currentMode));n.fields=n.fields.filter(function(t){return t.table_name===e.tableName&&t.name===e.name?null:t}),t.currentMode=n},ADD_NEW_CELL:function(t,e){var n=JSON.parse(JSON.stringify(t.currentMode));n.fields.push({table_name:e.tableName,name:e.name,min_normal:"",max_normal:""}),t.currentMode=n},CANCEL_MODE:function(t,e){t.currentMode=t.modes.filter(function(t){return t.id==e})[0]}},actions:{getModes:function(t){var e=t.commit;t.state,t.getters;return st.get(window.HOSTNAME+"/bl/modes_api/",{withCredentials:!0}).then(function(t){e("SET_MODES",t.data)}).catch(function(t){console.log(t)})},addMode:function(t,e){t.commit,t.state,t.getters;return st.post(window.HOSTNAME+"/bl/modes_api/",{message:e.mode.message,plant:e.mode.plant,journal:e.mode.journal,fields:e.mode.fields.map(function(t){return{table_name:t.table_name,name:t.name,min_normal:t.min_normal,max_normal:t.max_normal}})},{withCredentials:!0}).catch(function(t){console.log(t)})},toggleMode:function(t,e){t.commit,t.state,t.getters;return st.put(window.HOSTNAME+"/bl/modes_api/",{id:e.modeId,is_active:e.isActive},{withCredentials:!0}).catch(function(t){console.log(t)})},deleteMode:function(t,e){t.commit,t.state,t.getters;return st.delete(window.HOSTNAME+"/bl/modes_api/".concat(e.modeId),{withCredentials:!0}).catch(function(t){console.log(t)})},updateMode:function(t,e){t.commit,t.state,t.getters;return st.put(window.HOSTNAME+"/bl/modes_api/",e,{withCredentials:!0}).catch(function(t){console.log(t)})}}}),Ce=be,je=(n("ac4d"),n("8a81"),-1);function Se(t){return!isNaN(parseFloat(t))&&isFinite(t)}var xe={namespaced:!0,state:{settings:[],searchByName:"",currentModel:""},getters:{searchByName:function(t){return t.searchByName},currentModel:function(t){return t.currentModel},getSettings:function(t){return t.settings.filter(function(t){return"field_description"===t.name})},favorites:function(t){return t.settings.filter(function(t){return t.isFavorite})},filtredByName:function(t){return 0<t.searchByName.length?t.settings.filter(function(e){return e.scope.name.indexOf(t.searchByName)>je&&"field_description"===e.name}):t.settings.filter(function(t){return"field_description"===t.name})}},mutations:{SET_CURRENT_MODEL:function(t,e){t.currentModel=e},SET_SETTINGS:function(t,e){t.settings=e},SET_SEARCH_BY_NAME:function(t,e){t.searchByName=e},UPDATE_MODEL_VALUE:function(t,e){var n=JSON.parse(JSON.stringify(t.currentModel));n.value[e.propName]=+e.value,t.currentModel=n},UPDATE_MODEL_PROP:function(t,e){var n=JSON.parse(JSON.stringify(t.currentModel));n[e.sectionName][e.propName]=Se(e.value)?+e.value:e.value,t.currentModel=n}},actions:{setCurrentModel:function(){},loadSettings:function(t){var e=t.commit;t.state,t.getters;return st.get("http://localhost:8000/api/settings/",{withCredentials:!0}).then(function(t){var n=t.data.settings,a=!0,s=!1,o=void 0;try{for(var i,r,l=n[Symbol.iterator]();!(a=(i=l.next()).done);a=!0)r=i.value,r.isFavorite=!1}catch(t){s=!0,o=t}finally{try{a||null==l.return||l.return()}finally{if(s)throw o}}e("SET_SETTINGS",n)})},addSetting:function(t,e){t.commit,t.state,t.getters;console.log("addSetting",e)},updateSetting:function(t,e){t.commit;var n=t.state,a=t.getters;return console.log("updateSetting",e,"state: ",n,"getters",a),st.put("http://localhost:8000/api/settings/",e,{withCredentials:!0}).then(function(t){console.log(t)}).catch(function(t){console.log(t)})}}},we=xe,ye=new pe["a"]({storage:window.localStorage});a["a"].use(fe["a"]);var Ne=new fe["a"].Store({modules:{journalState:ve,userState:_e,modesState:Ce,settingsState:we},plugins:[ye.plugin]}),Me=Ne,$e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{directives:[{name:"show",rawName:"v-show",value:t.isActive,expression:"isActive"}],class:[{active:t.isActive},"tab-section"]},[t._t("default")],2)},Ee=[],ke={name:"tab",props:{id:String},data:function(){return{isActive:!1}}},Te=ke,Oe=(n("b21f"),Object(l["a"])(Te,$e,Ee,!1,null,"9ca60604",null));Oe.options.__file="tab.vue";var Ae=Oe.exports,Ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{staticClass:"tabs"},[n("ul",{staticClass:"nav nav-tabs"},t._l(t.items,function(e){return n("li",{key:e.id,staticClass:"nav-item",on:{click:function(n){t.selectTab(e.id)}}},[n("a",{class:t.getClasses(e.id),attrs:{href:"#"}},[t._v(t._s(e.title))])])})),t._t("default")],2)},Le=[],De={name:"tabs",props:["items","first"],data:function(){return{activeIndex:0,tabs:[]}},mounted:function(){console.log("mounted"),this.selectTab(this.first)},created:function(){this.tabs=this.$children,console.log("created")},methods:{getClasses:function(t){return this.activeIndex===1*t?"nav-link active":"nav-link "},selectTab:function(t){console.log(t);var e=""+t,n=this.tabs.find(function(t){return t.id===e});console.log(" selected: ",n),n.isActive=!0,this.activeIndex=+t,this.tabs.forEach(function(t){t.isActive=t.id===e})}}},Pe=De,Re=(n("883a"),Object(l["a"])(Pe,Ie,Le,!1,null,"059b6e01",null));Re.options.__file="tabs.vue";var Ue=Re.exports;a["a"].use(me.a),a["a"].component("cell",se),a["a"].component("Cell",se),a["a"].component("table-comment",ue);var Ve,ze,Fe={name:"TableCommon",props:["name","index"],data:function(){return{fact:!1,template:null,rowsCount:1,months:{January:"Январь",February:"Февраль",March:"Март",April:"Апрель",May:"Май",June:"Июнь",July:"Июль",August:"Август",September:"Сентябрь",October:"Октябрь",November:"Ноябрь",December:"Декабрь"}}},render:function(t){var e=this;return this.template?t({template:'<div class="journal-table" id="table_id_'+this.name+'">'+this.template+'<table-comment table-name="'+this.name+'"></table-comment></div>',name:"table-"+this.name,data:function(){return{data:e.$data,props:e.$props}},watch:{rowsCount:function(){setTimeout(function(){$(".elog-journal-table td").each(function(){$(this).height($(this).height())})},0)}},computed:{shiftOrder:function(){return this.$store.getters["journalState/shiftOrder"]},rowsCount:function(){return this.$store.getters["journalState/maxRowIndex"](this.props.name)+1}},components:{cell:se,"table-comment":ue,tab:Ae,tabs:Ue},mounted:function(){setTimeout(function(){$(".elog-journal-table td").each(function(){$(this).height($(this).height())})},0)}}):t({template:'<div class="spinner-container"><i class="spinner"></i></div>'})},mounted:function(){var t=this,e=window.HOSTNAME+"/templates/tables/"+this.$store.getters["journalState/plantName"]+"/"+this.$store.getters["journalState/journalName"]+"/"+this.name+"/";st.get(e).then(function(e){var n=$("<div />").append($(e.data).clone());n.find("table").each(function(){$(this).parent().is("div")&&$(this).wrap("<div style='overflow-x: auto; margin-bottom: 20px;'></div>")}),t.template=n[0].outerHTML}).catch(function(t){console.log("error: ",t)})}},Je=Fe,He=Object(l["a"])(Je,Ve,ze,!1,null,null,null);He.options.__file="TableCommon.vue";var Be=He.exports,We=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"journal__panel"},[a("div",{staticClass:"date-selector"},[a("label",[t._v("Выберите дату и смену")]),a("input",{staticClass:"date-selector__date",attrs:{id:"shift_field",type:"text",placeholder:"Выберите дату...","data-toggle":"modal","data-target":"#myModal"},domProps:{value:t.shiftDate+", "+t.shiftOrder+"-ая смена"},on:{click:function(e){t.showCalendar=!0}}})]),a("div",{staticClass:"panel-buttons"},[a("div",{staticClass:"mode-buttons"},[t._l(t.responsibles,function(t){return a("img",{staticStyle:{height:"30px",width:"30px"},attrs:{title:Object.values(t)[0],src:n("115e")}})}),a("button",{class:["btn","btn-view",{"btn--active":"view"===t.mode}],on:{click:function(e){t.changeMode("view")}}},[t._v("\n                Просмотр\n            ")]),a("button",{class:["btn","btn-edit",{"btn--active":"edit"===t.mode}],on:{click:function(e){t.changeMode("edit")}}},[t._v("\n                Редактирование\n            ")]),a("button",{class:["btn","btn-validate",{"btn--active":"validate"===t.mode}],on:{click:function(e){t.changeMode("validate")}}},[t._v("\n                Валидация\n            ")])],2),a("button",{class:["btn","btn-xlsx","float-right"],on:{click:function(e){t.download_xlsx()}}},[t._v("\n            XLSX\n        ")])]),a("modal",{directives:[{name:"show",rawName:"v-show",value:t.showCalendar,expression:"showCalendar"}],on:{close:function(e){t.showCalendar=!1}}},[a("full-calendar",{ref:"calendar",attrs:{events:t.events,config:t.fullCalendarConfig}})],1)],1)},Ge=[],Ye=n("25cc"),Ke=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("transition",{attrs:{name:"modal"}},[n("div",{staticClass:"modal-mask"},[n("div",{staticClass:"modal-wrapper"},[n("div",{staticClass:"modal-container"},[n("div",{staticClass:"modal-body"},[t._t("default")],2),n("div",{staticClass:"modal-footer"},[t.action?n("button",{staticClass:"btn btn-success",on:{click:t.action.callback}},[t._v(t._s(t.action.title))]):t._e(),t._v(" \n            "),n("button",{staticClass:"modal-default-button btn btn-default",on:{click:function(e){t.$emit("close")}}},[t._v("Закрыть")])])])])])])},qe=[],Ze={name:"modal",props:{action:Object},data:function(){return{}}},Qe=Ze,Xe=(n("4c8a"),Object(l["a"])(Qe,Ke,qe,!1,null,"34d50682",null));Xe.options.__file="Modal.vue";var tn=Xe.exports,en=n("1146"),nn={name:"journal-panel",data:function(){return{showCalendar:!1,employeeName:"Employee name",employeePosition:"position",fullCalendarConfig:{locale:"ru",buttonText:{today:"Сегодня",month:"Месяц",week:"Неделя",day:"День",list:"Список"},timeFormat:"H(:mm)",header:{left:"prev,next today",center:"title",right:"month, listMonth"},selectable:!0,selectHelper:!0,select:function(){},eventClick:function(){console.log("event click")},editable:!1}}},computed:{responsibles:function(){return this.$store.getters["journalState/journalInfo"].responsibles},events:function(){return this.$store.getters["journalState/events"]},employeeFormatted:function(){return this.employeeName+" : "+this.employeePosition},mode:function(){return this.$store.getters["journalState/journalInfo"].mode},shiftDate:function(){return this.$store.getters["journalState/journalInfo"].date},shiftOrder:function(){return this.$store.getters["journalState/journalInfo"].order}},methods:{changeMode:function(t){for(var e=this.$store.getters["journalState/journalInfo"].permissions.permissions,n=0;n<e.length;n++)t+"_cells"===e[n]&&this.$store.commit("journalState/SET_PAGE_MODE",t)},download_xlsx:function(){var t=M()(".elog-journal-table").clone();t.find("td").replaceWith(function(){return"<td>"+M()(this).find("input.general-value").val()+"</td>"});for(var e,n=t.get(),a=en.utils.book_new(),s=0;s<n.length;s++)e=en.utils.table_to_sheet(n[s]),en.utils.book_append_sheet(a,e,"table"+s);en.writeFile(a,"journal.xlsx")}},mounted:function(){this.$store.dispatch("journalState/loadShifts",{plant:this.$route.params.plant,journal:this.$route.params.journal}),M()(window).resize(function(){console.log("resize"),setTimeout(function(){M()(".fc-scroller.fc-day-grid-container").css({overflow:"auto",height:"400px"})},100)}),M()(".fc-toolbar.fc-header-toolbar button").click(function(){setTimeout(function(){M()(".fc-scroller.fc-day-grid-container").css({overflow:"auto",height:"400px"})},1)})},components:{modal:tn,FullCalendar:Ye["a"]}},an=nn,sn=(n("1548"),Object(l["a"])(an,We,Ge,!1,null,null,null));sn.options.__file="JournalPanel.vue";var on=sn.exports,rn={name:"JournalPage",components:{tablecommon:Be,"journal-panel":on},updated:function(){},methods:{openConstructor:function(){window.open("http://127.0.0.1:8085","_blank")}},mounted:function(){var t=this;console.log("mounted"),this.$connect(),window.parser.setVariable("CURRENT_SHIFT",this.$route.params.shift_id),this.$route.params.shift_id?this.$store.dispatch("journalState/loadJournal",{id:this.$route.params.shift_id}).then(function(e){t.$router.push("/"+t.$route.params.plant+"/"+t.$route.params.journal+"/"+e),t.$store.dispatch("journalState/loadShifts",{plant:t.$route.params.plant,journal:t.$route.params.journal})}):this.$route.params.plant&&this.$route.params.journal&&this.$store.dispatch("journalState/loadJournal",{plantName:this.$route.params.plant,journalName:this.$route.params.journal}).then(function(e){t.$router.push("/"+t.$route.params.plant+"/"+t.$route.params.journal+"/"+e),t.$store.dispatch("journalState/loadShifts",{plant:t.$route.params.plant,journal:t.$route.params.journal})})}},ln=rn,cn=(n("f775"),Object(l["a"])(ln,Jt,Ht,!1,null,"22337c4a",null));cn.options.__file="JournalPage.vue";var un=cn.exports,dn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("div",{staticClass:"mainbox col-md-6 col-md-offset-3 col-sm-8 col-sm-offset-2 centered-vertically",attrs:{id:"loginbox"}},[n("div",{staticClass:"panel panel-info"},[t._m(0),n("div",{staticClass:"panel-body",staticStyle:{"padding-top":"30px"}},[n("div",{staticClass:"alert alert-danger col-sm-12",style:{display:t.errorText?"block":"none"},attrs:{id:"login-alert"}},[t._v("\n                    "+t._s(t.errorText)+"\n                ")]),n("form",{staticClass:"form-horizontal",attrs:{id:"loginform"}},[t._m(1),t._m(2),n("div",{staticClass:"form-group",staticStyle:{"margin-top":"10px"}},[n("div",{staticClass:"controls"},[n("input",{staticClass:"btn",staticStyle:{"background-color":"#26B99A",height:"36px"},attrs:{type:"submit",value:"Вход"},on:{click:function(e){return e.preventDefault(),t.onSubmit(e)}}})])])])])])])])},mn=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"panel-heading",staticStyle:{"background-color":"#2A3F54",color:"white"}},[n("div",{staticClass:"panel-title"},[t._v("Вход в систему электронных журналов")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group",staticStyle:{"margin-bottom":"25px"}},[n("div",{staticClass:"input-group-prepend"},[n("div",{staticClass:"input-group-text"},[n("i",{staticClass:"fa fa-user"})])]),n("input",{staticClass:"form-control",attrs:{id:"login-username",type:"text",name:"username",value:"",placeholder:"Имя пользователя"}})])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"input-group",staticStyle:{"margin-bottom":"25px"}},[n("div",{staticClass:"input-group-prepend"},[n("div",{staticClass:"input-group-text"},[n("i",{staticClass:"fa fa-lock"})])]),n("input",{staticClass:"form-control",attrs:{id:"login-password",type:"password",name:"password",placeholder:"Пароль"}})])}],fn={name:"LoginPage",data:function(){return{errorText:""}},methods:{onSubmit:function(){var t=M()('input[name="username"]').val(),e=M()('input[name="password"]').val();t&&e?(this.errorText="",this.login(t,e)):this.errorText="Введите все данные!"},login:function(t,e){var n=this;this.$store.dispatch("userState/login",{username:t,password:e}).then(function(){n.$router.push("/")}).catch(function(t){400===t.response.status&&(n.errorText="Данные некорректны!")})}}},pn=fn,hn=(n("f9a4"),Object(l["a"])(pn,dn,mn,!1,null,"82987444",null));hn.options.__file="LoginPage.vue";var vn=hn.exports,gn=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"messages"},[a("ul",{staticClass:"messages__list"},[t.messages.length?t._l(t.messages,function(e){return a("li",{key:e.id,staticClass:"message"},[e.sendee?[a("img",{staticClass:"message__image",attrs:{src:n("115e")}}),a("span",{staticClass:"message__author-name"},[t._v(t._s(e.user_name))]),a("strong",{staticClass:"message__title"},[a("a",{staticClass:"sendee",attrs:{href:"#"}},[t._v(t._s(e.sendee))]),a("span",{staticClass:"message__info"}),a("a",{attrs:{href:e.link}},[t._v(t._s(e.cell.field.name))])])]:[a("p",{class:["message__text",e.type]},[t._v(t._s(e.text))]),a("span",{staticClass:"message__created"},[t._v(t._s(e.created))])]],2)}):a("h1",{staticStyle:{"text-align":"center"}},[t._v("Нет сообщений")])],2),a("div",{staticClass:"loading",staticStyle:{display:"none","text-align":"center"}},[t._v("\n        ЗАГРУЗКА...\n    ")])])},_n=[],bn={name:"MessagesPage",data:function(){return{messages:[]}},mounted:function(){}},Cn=bn,jn=(n("07d3"),Object(l["a"])(Cn,gn,_n,!1,null,"e232f93a",null));jn.options.__file="MessagesPage.vue";var Sn=jn.exports,xn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"settings-page"},[n("settings-list")],1)},wn=[],yn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"settings"},[n("modal",{directives:[{name:"show",rawName:"v-show",value:t.isEditing,expression:"isEditing"}],attrs:{action:t.customAction},on:{close:t.closeModal}},[n("div",{staticClass:"panel panel-info"},[n("div",{staticClass:"panel-heading"},[n("h3",{staticClass:"panel-title"},[t._v("Окно редактирования setting'a")])]),n("div",{staticClass:"panel-body"},[t.currentModel?n("setting-edit",{attrs:{model:t.currentModel}}):t._e()],1)])]),n("div",{staticClass:"table-container"},[n("table",{staticClass:"settings-list table table-striped"},[t._m(0),n("tbody",t._l(t.filtredByName,function(t){return n("setting-item",{key:t.id,attrs:{model:t}})}))])])],1)},Nn=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("#")]),n("th",[t._v("Type")]),n("th",[t._v("Name")]),n("th",[t._v("Value")]),n("th",[t._v("User")]),n("th",[t._v("Scope")])])])}],Mn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",{staticClass:"setting-item"},[n("td"),n("td",[t._v(t._s(t.model.name))]),n("td",[t._v(t._s(t.title))]),n("td",[n("button",{staticClass:"btn btn-info",staticStyle:{"font-size":"10px"}},[n("i",{staticClass:"material-icons",on:{click:function(e){t.editModel()}}},[t._v("build")])]),t._v(" \n        "),n("code",[t._v(t._s(t.model.value))])]),n("td"),n("td",[n("code",[t._v(t._s(t.model.scope))])])])},$n=[],En={name:"setting-item",props:{model:Object},data:function(){return{type:"text",isEditing:!1}},computed:{title:function(){return this.model.scope.name},isFavorite:function(){return!!this.model&&this.model.isFavorite}},methods:{editModel:function(){this.$store.commit("settingsState/SET_CURRENT_MODEL",this.model),this.$parent.isEditing=!0},markAsFavorite:function(){console.log("mark as favorite"),this.model.isFavorite=!this.model.isFavorite}},mounted:function(){this.type=this.model.type}},kn=En,Tn=(n("44bc"),Object(l["a"])(kn,Mn,$n,!1,null,"6d20e3d0",null));Tn.options.__file="SettingItem.vue";var On=Tn.exports,An=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"field-description"},[n("tabs",{attrs:{items:t.items,first:"1"}},[n("tab",{attrs:{id:"1"}},[n("div",{staticClass:"model_value"},[n("field-prop-edit",{attrs:{section:"value",name:"type",value:t.model.value.type}}),n("field-prop-edit",{attrs:{section:"value",name:"min_normal",value:t.model.value.min_normal}}),n("field-prop-edit",{attrs:{title:"max_normal",section:"value",name:"max_normal",value:t.model.value.max_normal}}),n("field-prop-edit",{attrs:{title:"units",section:"value",name:"units",value:t.model.value.units}}),"datalist"===t.model.value.type?n("ul",{staticClass:"list-group"},t._l(t.model.value.options,function(e){return n("li",{staticClass:"list-group-item"},[t._v(t._s(e))])})):t._e()],1)]),n("tab",{attrs:{id:"2"}},[n("div",{staticClass:"model_scope"},[n("field-prop-edit",{attrs:{section:"scope",name:"id",value:t.model.scope.id}}),n("field-prop-edit",{attrs:{section:"scope",name:"name",value:t.model.scope.name}}),n("field-prop-edit",{attrs:{section:"scope",name:"verbose_name",value:t.model.scope.verbose_name}}),n("field-prop-edit",{attrs:{section:"scope",name:"table",value:t.model.scope.table}}),n("field-prop-edit",{attrs:{section:"scope",name:"type",value:t.model.scope.type}})],1)])],1)],1)},In=[],Ln=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"form-group"},[n("label",{attrs:{for:t.fieldId}},[t._v(t._s(t.name))]),n("input",{staticClass:"form-control",attrs:{id:t.fieldId,type:"text"},domProps:{value:t.value},on:{change:function(e){return t.onChange(e.target.value)}}})])},Dn=[],Pn={name:"FieldPropEdit",props:["section","name","value"],computed:{fieldId:function(){return this.section+"_"+this.name}},methods:{onChange:function(t){this.$store.commit("settingsState/UPDATE_MODEL_PROP",{sectionName:this.section,propName:this.name,value:t})}}},Rn=Pn,Un=(n("cc99"),Object(l["a"])(Rn,Ln,Dn,!1,null,"321b8b8a",null));Un.options.__file="FieldPropEdit.vue";var Vn=Un.exports,zn={name:"SettingEdit",props:{model:Object},data:function(){return{items:[{id:1,title:"Value"},{id:2,title:"Scope"}]}},methods:{onInputChange:function(t,e){this.$store.commit("settingsState/UPDATE_MODEL_VALUE",{propName:t,value:e})}},components:{Tab:Ae,Tabs:Ue,FieldPropEdit:Vn}},Fn=zn,Jn=(n("9e0d"),Object(l["a"])(Fn,An,In,!1,null,"56bd0883",null));Jn.options.__file="SettingEdit.vue";var Hn=Jn.exports,Bn={name:"SettingsList",data:function(){return{isEditing:!1}},computed:{customAction:function(){var t=this;return{callback:t.saveCurrentSetting,title:"Сохранить"}},currentModel:function(){return this.$store.getters["settingsState/currentModel"]},settings:function(){return this.$store.getters["settingsState/getSettings"]},filtredByName:function(){return this.$store.getters["settingsState/filtredByName"]},countSettings:function(){return this.filtredByName.length},searchByName:{get:function(){return this.$store.getters["settingsState/searchByName"]},set:function(t){this.$store.commit("settingsState/SET_SEARCH_BY_NAME",t)}}},methods:{closeModal:function(){this.isEditing=!1,this.$store.commit("settingsState/SET_CURRENT_MODEL",null)},saveCurrentSetting:function(){var t=this,e=this.currentModel;this.$store.dispatch("settingsState/updateSetting",e).then(function(e){console.log("current model",e),t.isEditing=!1,t.$store.commit("settingsState/SET_CURRENT_MODEL",null)})},uncheckAllSettings:function(){var t=this.$store.getters.getSettings,e=!0,n=!1,a=void 0;try{for(var s,o,i=t[Symbol.iterator]();!(e=(s=i.next()).done);e=!0)o=s.value,o.isFavorite=!1}catch(t){n=!0,a=t}finally{try{e||null==i.return||i.return()}finally{if(n)throw a}}this.$store.commit("settingsState/SET_SETTINGS",t)},loadSettingsFromAPI:function(){this.$store.dispatch("settingsState/loadSettings").then(function(){console.log("load settings")})}},mounted:function(){this.loadSettingsFromAPI()},components:{SettingEdit:Hn,Modal:tn,SettingItem:On}},Wn=Bn,Gn=(n("e16b"),Object(l["a"])(Wn,yn,Nn,!1,null,"32866f69",null));Gn.options.__file="SettingsList.vue";var Yn=Gn.exports,Kn={name:"settings-page",props:{},data:function(){return{isShowHelp:!1}},components:{SettingsList:Yn}},qn=Kn,Zn=(n("ae81"),Object(l["a"])(qn,xn,wn,!1,null,"891c8b2e",null));Zn.options.__file="SettingsPage.vue";var Qn=Zn.exports,Xn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mode-content"},[n("div",{staticClass:"mode-content__title"},[n("div",{staticClass:"mode-content__title__mode-info"},[n("h3",{attrs:{id:"modeTitle"}},[t.currentMode?n("span",[t._v(t._s(t.currentMode.message))]):n("span",[t._v("Выберите режим")])])]),t.currentMode?[n("div",{staticClass:"mode-content__title__mode-btns"},[t.currentMode.is_active?n("button",{staticClass:"btn",attrs:{value:"off"},on:{click:function(e){e.preventDefault(),t.toggleMode(0)}}},[t._v("Выключить")]):n("button",{staticClass:"btn",attrs:{value:"on"},on:{click:function(e){e.preventDefault(),t.toggleMode(1)}}},[t._v("Включить")]),n("button",{staticClass:"btn",attrs:{"data-target":"mode-delete"},on:{click:function(e){return e.preventDefault(),t.onDeleteMode(e)}}},[t._v("Удалить")])])]:t._e()],2),n("div",{staticClass:"mode-content__body"},[n("div",{staticClass:"table-container"},[t.currentMode?n("table",{staticClass:"table table-bordered elog-journal-table"},[t._m(0),n("tbody",t._l(t.currentMode.fields,function(e,a){return n("tr",{key:e.name+"-"+a},[n("td",{attrs:{"data-target":"table_name"}},[n("div",[t._v(t._s(e.table_name))])]),n("td",{attrs:{"data-target":"name"}},[n("div",[t._v(t._s(e.name))])]),n("td",{attrs:{"data-target":"min_normal"}},[n("input",{staticClass:"form-control",attrs:{type:"number"},domProps:{value:e.min_normal},on:{input:function(n){return t.onChangeCellValue("min_normal",e.table_name,e.name,n.target.value)}}})]),n("td",{attrs:{"data-target":"max_normal"}},[n("input",{staticClass:"form-control",attrs:{type:"number"},domProps:{value:e.max_normal},on:{input:function(n){return t.onChangeCellValue("max_normal",e.table_name,e.name,n.target.value)}}})]),n("td",[n("div",{staticClass:"delete-icon",on:{click:function(n){t.onDeleteCell(e.table_name,e.name)}}},[n("i",{staticClass:"fas fa-times"})])])])}))]):t._e()]),t.currentMode?n("div",{staticClass:"mode-content__title__mode-edit-btns"},[n("button",{staticClass:"btn",attrs:{"data-toggle":"modal","data-target":"#AddModeCellModal"}},[t._v("Добавить ячейку")]),t.needsToSave?n("div",[n("button",{staticClass:"btn",staticStyle:{"margin-right":"10px"},attrs:{"data-target":"mode-cancel"},on:{click:function(e){return e.preventDefault(),t.onCancelMode(e)}}},[t._v("Отмена")]),n("button",{staticClass:"btn",attrs:{"data-target":"mode-save"},on:{click:function(e){return e.preventDefault(),t.onSaveMode(e)}}},[t._v("Сохранить")])]):t._e()]):t._e()]),n("add-mode-cell-modal",{on:{"on-add-cell":function(e){t.needsToSave=!0}}})],1)},ta=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("thead",[n("tr",[n("th",[t._v("Таблица")]),n("th",[t._v("Ячейка")]),n("th",[t._v("Минимальное значение")]),n("th",[t._v("Максимальное значение")]),n("th",{staticStyle:{width:"36px"}})])])}],ea=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal fade",attrs:{id:"AddModeCellModal",tabindex:"-1",role:"dialog","aria-labelledby":"AddModeCellModal","aria-hidden":"true"}},[n("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[n("div",{staticClass:"modal-content"},[t._m(0),n("div",{staticClass:"modal-body"},[n("form",[n("div",{staticClass:"form-group"},[n("label",{staticClass:"col-form-label",attrs:{for:"table_name"}},[t._v("Таблица")]),n("input",{staticClass:"form-control bordered",attrs:{type:"text",id:"table_name",placeholder:"Введите название таблицы",list:"table"},on:{input:function(e){return t.onInputChange("table",e.target.value)}}}),n("datalist",{attrs:{id:"table"}},t._l(t.tableList,function(t){return n("option",{key:"table-"+t.name,domProps:{value:t.name}})}))]),n("div",{staticClass:"form-group"},[n("label",{staticClass:"col-form-label",attrs:{for:"name"}},[t._v("Ячейка")]),n("input",{staticClass:"form-control bordered",attrs:{type:"text",id:"name",placeholder:"Введите название ячейки",list:"field"},on:{input:function(e){return t.onInputChange("field",e.target.value)}}}),t.table_name?n("datalist",{attrs:{id:"field"}},t._l(t.fieldList,function(e){return n("option",{key:"field-"+e.name+"-"+t.index,domProps:{value:e.name}})})):t._e()])])]),n("div",{staticClass:"modal-footer"},[n("button",{staticClass:"btn",attrs:{type:"button","data-dismiss":"modal"}},[t._v("Закрыть")]),n("button",{staticClass:"btn",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),t.onAddCell(e)}}},[t._v("Добавить")])])])])])},na=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"modal-header"},[n("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[n("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]),n("h5",{staticClass:"modal-title"},[t._v(" Добавление ячейки ")])])}],aa={name:"AddModeCellModal",data:function(){return{table_name:"",name:"",tableList:[],fieldList:[]}},computed:{getCurrentPlant:function(){return this.$store.getters["modesState/currentMode"].plant},getCurrentJournal:function(){return this.$store.getters["modesState/currentMode"].journal}},methods:{onAddCell:function(){this.$store.commit("modesState/ADD_NEW_CELL",{tableName:$("input[id=table_name]").val(),name:$("input[id=name]").val()}),$("#AddModeCellModal button.close").trigger("click"),this.$emit("on-add-cell")},getExistingName:function(t,e){var n=this[t].filter(function(t){return t.name===e})[0];return n?n.name:void 0},onInputChange:function(t,e){var n=this;"table"===t?this.getTables(this.getCurrentPlant,this.getCurrentJournal).then(function(){n.getExistingName("tableList",e)?n.table_name=e:(n.table_name="",n.fieldList=[])}):"field"==t&&this.table_name&&this.getFields(this.getCurrentPlant,this.getCurrentJournal,this.table_name).then(function(){n.name=n.getExistingName("fieldList",e)?e:""})},getTables:function(t,e){var n=this;return st.get(window.HOSTNAME+"/api/tables/?plant=".concat(t,"&journal=").concat(e),{withCredentials:!0}).then(function(t){n.tableList=t.data}).catch(function(t){console.log(t)})},getFields:function(t,e,n){var a=this;return st.get(window.HOSTNAME+"/api/fields/?plant=".concat(t,"&journal=").concat(e,"&table=").concat(n),{withCredentials:!0}).then(function(t){a.fieldList=t.data}).catch(function(t){console.log(t)})}}},sa=aa,oa=(n("600e"),Object(l["a"])(sa,ea,na,!1,null,"14f52eb2",null));oa.options.__file="AddModeCellModal.vue";var ia=oa.exports,ra={name:"ModesPage",components:{"add-mode-cell-modal":ia},data:function(){return{needsToSave:!1}},computed:{currentMode:{get:function(){return this.$store.getters["modesState/currentMode"]},set:function(t){this.$store.commit("modesState/SET_CURRENT_MODE",t)}}},methods:{onDeleteCell:function(t,e){this.$store.commit("modesState/DELETE_CELL",{tableName:t,name:e}),this.needsToSave=!0},onCancelMode:function(){this.$store.commit("modesState/CANCEL_MODE",this.getURLParameter("modeId")),this.needsToSave=!1},onSaveMode:function(){var t=this;this.$store.dispatch("modesState/updateMode",this.currentMode).then(function(){t.$store.dispatch("modesState/getModes").then(function(){t.currentMode=t.getURLParameter("modeId")})}),this.needsToSave=!1},onChangeCellValue:function(t,e,n,a){this.$store.commit("modesState/CHANGE_CELL_VALUE",{dataType:t,tableName:e,name:n,value:a}),this.needsToSave=!0},toggleMode:function(t){var e=this;this.$store.dispatch("modesState/toggleMode",{modeId:this.currentMode.id,isActive:t}).then(function(){e.$store.dispatch("modesState/getModes").then(function(){e.currentMode=e.getURLParameter("modeId")})})},onDeleteMode:function(){var t=this;this.$store.dispatch("modesState/deleteMode",{modeId:this.currentMode.id}).then(function(){t.currentMode=null,t.$router.push("/modes")}).then(function(){t.$store.dispatch("modesState/getModes")})},getURLParameter:function(t){for(var e,n=window.location.search.substring(1),a=n.split("&"),s=0;s<a.length;s++)if(e=a[s].split("="),e[0]===t)return e[1];return""}},destroyed:function(){this.currentMode=null},mounted:function(){var t=this;this.$store.dispatch("modesState/getModes").then(function(){t.currentMode=t.getURLParameter("modeId")?t.getURLParameter("modeId"):null})}},la=ra,ca=(n("7a07"),Object(l["a"])(la,Xn,ta,!1,null,null,null));ca.options.__file="ModesPage.vue";var ua=ca.exports,da=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"load-journal-content"},[n("form",[n("h3",{staticStyle:{"margin-bottom":"30px"}},[t._v("Загрузить журнал:")]),t.errorText?n("span",{staticStyle:{color:"red"}},[t._v(t._s(t.errorText))]):t._e(),n("p",[n("input",{attrs:{accept:".journal",id:"journal_upload_button",type:"file",value:"Обзор",name:"journal_file"},on:{change:function(e){t.file=e.target.files[0]}}})]),n("p",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.plant,expression:"plant"}],attrs:{name:"plant"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.plant=e.target.multiple?n:n[0]}}},[n("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("Выберите цех")]),n("option",{attrs:{value:"furnace"}},[t._v("Обжиг")]),n("option",{attrs:{value:"leaching"}},[t._v("Выщелачивание")]),n("option",{attrs:{value:"electrolysis"}},[t._v("Электролиз")])])]),n("p",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.journal,expression:"journal"}],attrs:{name:"type"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.journal=e.target.multiple?n:n[0]}}},[n("option",{attrs:{disabled:"",selected:"",value:""}},[t._v("Выберите тип журнала")]),n("option",{attrs:{value:"shift"}},[t._v("Смена")]),n("option",{attrs:{value:"equipment"}},[t._v("Оборудование")]),n("option",{attrs:{value:"measurement"}},[t._v("Измерение")])])]),n("p",{staticStyle:{"text-align":"right"}},[n("input",{staticClass:"btn",attrs:{type:"submit",value:"Загрузить"},on:{click:function(e){return e.preventDefault(),t.onLoadJournal(e)}}})])])])},ma=[],fa={name:"SettingsPage",data:function(){return{errorText:"",plant:"",journal:"",file:null}},methods:{onLoadJournal:function(){console.dir(this.file)}}},pa=fa,ha=(n("4923"),Object(l["a"])(pa,da,ma,!1,null,"0ea8db1f",null));ha.options.__file="AddJournal.vue";var va=ha.exports;a["a"].use(d["a"]);var ga=new d["a"]({mode:"history",routes:[{path:"/",name:"basePage",component:wt,children:[{path:"/dashboard",name:"dashboard",component:Ft},{path:"/:plant/:journal/:shift_id",name:"defaultJournalPage",component:un},{path:"/messages",name:"messagesPage",component:Sn},{path:"/addjournal",name:"addJournal",component:va},{path:"/settings",name:"settingsPage",component:Qn},{path:"/modes",name:"modesPage",component:ua}]},{path:"/login",name:"loginPage",component:vn}]});ga.beforeEach(function(t,e,n){f.a.get("Authorization")||"loginPage"===t.name?(console.dir(f.a.get("Authorization")),n()):n("/login")});var _a=ga,ba=n("b408"),Ca=n.n(ba),ja=(n("34ef"),n("a481"),n("14b9"),"BMD5Tv0jLvfZ65LEnMpnx-ZO2B-l9eGevOvaHVlmKe7SHAiP6awavzZhmoTOqYM10ImQgmVjgxhhfKDYnSxNJsQ");function Sa(t){for(var e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),a=window.atob(n),s=new Uint8Array(a.length),o=0;o<a.length;++o)s[o]=a.charCodeAt(o);return s}function xa(t){t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Sa(ja)}).then(function(t){st.post(window.HOSTNAME+"/common/messages/subscribe/",t,{withCredentials:!0,headers:{Authorization:"Token "+f.a.get("Authorization")}}).then(function(t){return t}).then(function(t){200===t.status?console.log("User is subscribed."):console.log("Error while subscribing user.")}).catch(function(t){console.error("error fetching subscribe",t)})}).catch(function(t){console.log("Failed to subscribe the user: ",t)})}"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").then(function(t){console.log("ServiceWorker registration successful with scope: ",t.scope),xa(t)}).catch(function(t){console.log("ServiceWorker registration failed: ",t)});n("2ef0"),n("4989"),n("df51"),n("684e"),n("228e"),n("6229"),n("d727"),n("54eb"),n("4fa8"),n("d4b8"),n("cb5b"),n("42b9");var wa=n("c665"),ya=n("aa9a"),Na=function(){function t(){Object(wa["a"])(this,t)}return Object(ya["a"])(t,null,[{key:"send",value:function(){console.log("SendMessageToDevelopers");var t=M()("#devs-message-theme").val(),e=M()("#devs-message-text").val(),n=document.URL.split("?")[0].split("/")[3],a=document.URL.split("?")[0].split("/")[4],s={theme:t,text:e,user:backend.user.username,email:backend.user.email,plant:n,journal:a};e&&t&&1e3>e.length&&200>t.length?(M()("#MessageToDevelopersModal").modal("hide"),M.a.ajax({type:"POST",url:window.HOSTNAME+"/feedback/send-message",data:s,success:console.log,dataType:"json"}),M()("#message-modal-alert").css("display","none"),M()("#devs-message-theme").val(""),M()("#devs-message-text").val("")):M()("#message-modal-alert").css("display","block")}}]),t}();M()(document).ready(function(){window.FeedBack=Na});n("38a1");var Ma=n("c1df"),$a=n.n(Ma);a["a"].filter("formatNumber",function(t){return numeral(t).format("00.00")}),a["a"].filter("formatDate",function(t){if(t)return $a()(t+"").format("DD.MM.YYYY hh:mm")}),a["a"].filter("formatHour",function(t){if(t)return $a()(t+"").format("hh")});n("c5f6"),n("e9d0");var Ea=n("e9d0").Parser,ka=n("01bb");function Ta(t){return!isNaN(t)}String.prototype.format||(String.prototype.format=function(){var t=arguments;return this.replace(/{(\d+)}/g,function(e,n){return"undefined"==typeof t[n]?e:t[n]})}),console.log("Loading formula...");var Oa=new Ea;window.parser=Oa,window.parser.setFunction("FUNC",function(t){var e=t[0],n=t[1],a=t[2],s=(t[3],t[4]),o=ka("GET","http://localhost:8000/api/cell/?journal={0}&table={1}&field={2}&shift={3}".format(e,n,a,s)),i=JSON.parse(o.getBody()),r=null;return r=Ta(i.value)?+i.value:window.parser.parse(i.value),r});function Aa(t){for(var e,n=window.location.search.substring(1),a=n.split("&"),s=0;s<a.length;s++)if(e=a[s].split("="),e[0]===t)return e[1];return""}Date.prototype.decrementMonth=function(){return new Date(this.setMonth(this.getMonth()-1))},Date.prototype.incrementMonth=function(){return new Date(this.setMonth(this.getMonth()+2))},Date.prototype.getMonthWithYear=function(){return this.getFullYear()+"-"+this.getMonth()},M()(document).ready(function(){var t=Aa("highlight");0<t.length&&setTimeout(function(){M()("table #"+t).addClass("highlight")},1e3)}),window.$=$,window.jQuery=jQuery,window._=_,window.Vue=a["a"];var Ia=n("69b4");Ia["init"]({dsn:"https://a86b628039394e4c89bea5b5b6835a8f@sentry.io/1299999",integrations:[new Ia["Integrations"].Vue({Vue:a["a"]})]}),Ia["configureScope"](function(t){t.setTag("server","kazzink")}),a["a"].config.productionTip=!1;var La="ws://"+window.location.hostname+":8000/e-logs/";window.HOSTNAME="http://localhost:8000",a["a"].use(Ca.a,La,{store:Me,format:"json",reconnection:!0,connectManually:!0,passToStoreHandler:function(t,e){var n=this;if("SOCKET_onopen"!==t||this.store.getters["journalState/isSynchronized"]){if("SOCKET_onmessage"!==t)return;var a=JSON.parse(e.data);if(console.log("data",JSON.parse(e.data)),console.log("event",e),"shift_data"==a.type){var s={cells:[]};for(var o in a.cells){var i=a.cells[o];this.store.getters["userState/username"]in i.responsible||s.cells.push({tableName:i.cell_location.table_name,fieldName:i.cell_location.field_name,index:i.cell_location.index,responsible:i.responsible,value:i.value})}console.log(s),0!==s.cells.length&&this.store.commit("journalState/SAVE_CELLS",s)}"messages"===a.type&&(console.log(a),!(this.store.getters["userState/username"]in a.employee)&&this.store.commit("journalState/SAVE_CELL_COMMENT",{tableName:a.cell_location.table_name,fieldName:a.cell_location.field_name,index:a.cell_location.index,comment:{text:a.message.text,created:Date.parse(a.created),user:a.employee}}))}else{var r=this.store.getters["journalState/unsyncJournalCells"]();r.map(function(t){n.store.dispatch("journalState/sendUnsyncCell",t)})}}}),Me.subscribe(function(){f.a.get("Authorization")||_a.push("/login")}),window.mv=new a["a"]({el:"#app",router:_a,store:Me,render:function(t){return t(u)},mounted:function(){}})},"5c0b":function(t,e,n){"use strict";var a=n("2856"),s=n.n(a);s.a},"600e":function(t,e,n){"use strict";var a=n("abc6"),s=n.n(a);s.a},"61c8":function(t,e,n){"use strict";var a=n("e6c4"),s=n.n(a);s.a},6570:function(t,e,n){},"6ae6":function(t,e,n){},"703e":function(t,e,n){},"729f":function(t,e,n){"use strict";var a=n("e74e"),s=n.n(a);s.a},"7a07":function(t,e,n){"use strict";var a=n("c4bc"),s=n.n(a);s.a},"7ea3":function(t,e,n){"use strict";var a=n("21a8"),s=n.n(a);s.a},8571:function(t,e,n){},"883a":function(t,e,n){"use strict";var a=n("93a6"),s=n.n(a);s.a},"899e":function(t,e,n){},"8c14":function(t,e,n){},"8e60":function(t,e,n){"use strict";var a=n("94ec"),s=n.n(a);s.a},"90e6":function(t,e,n){},"93a6":function(t,e,n){},"940c":function(t,e,n){"use strict";var a=n("b6a9"),s=n.n(a);s.a},"94ec":function(t,e,n){},"9e0d":function(t,e,n){"use strict";var a=n("c771"),s=n.n(a);s.a},a251:function(t,e,n){},a715:function(t,e,n){},a8d4:function(t,e,n){},aa1c:function(t,e,n){t.exports=n.p+"a27cb894a2369fc7975baf7456f0a751.pdf"},abc6:function(t,e,n){},ae81:function(t,e,n){"use strict";var a=n("703e"),s=n.n(a);s.a},b21f:function(t,e,n){"use strict";var a=n("8c14"),s=n.n(a);s.a},b454:function(t,e,n){},b6a9:function(t,e,n){},bc57:function(t,e,n){"use strict";var a=n("0f96"),s=n.n(a);s.a},c4bc:function(t,e,n){},c771:function(t,e,n){},cc99:function(t,e,n){"use strict";var a=n("2d31"),s=n.n(a);s.a},d400:function(t,e,n){},d46a:function(t,e,n){"use strict";var a=n("a251"),s=n.n(a);s.a},d5ae:function(t,e,n){},e16b:function(t,e,n){"use strict";var a=n("54bb"),s=n.n(a);s.a},e6c4:function(t,e,n){},e74e:function(t,e,n){},ed58:function(t,e,n){},f775:function(t,e,n){"use strict";var a=n("a715"),s=n.n(a);s.a},f9a4:function(t,e,n){"use strict";var a=n("899e"),s=n.n(a);s.a}});
//# sourceMappingURL=app.ddd62d7e.js.map